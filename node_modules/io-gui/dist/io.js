class NodeBindings{constructor(e){Object.defineProperty(this,"node",{value:e,configurable:!0})}get(e){return this[e]=this[e]||new Binding(this.node,e),this[e]}dispose(){for(let e in this)this[e].dispose(),delete this[e];delete this.node}}class Binding{constructor(e,t){this.source=e,this.sourceProp=t,this.targets=[],this.targetsMap=new WeakMap,this._onTargetChanged=this._onTargetChanged.bind(this),this._onSourceChanged=this._onSourceChanged.bind(this),this.source.addEventListener(this.sourceProp+"-changed",this._onSourceChanged)}get value(){return this.source[this.sourceProp]}addTarget(e,t){if(-1===this.targets.indexOf(e)&&this.targets.push(e),this.targetsMap.has(e)){const o=this.targetsMap.get(e);-1===o.indexOf(t)&&(o.push(t),e.addEventListener(t+"-changed",this._onTargetChanged))}else this.targetsMap.set(e,[t]),e.addEventListener(t+"-changed",this._onTargetChanged)}removeTarget(e,t){if(this.targetsMap.has(e)){const o=this.targetsMap.get(e);if(t){const i=o.indexOf(t);-1!==i&&o.splice(i,1),e.removeEventListener(t+"-changed",this._onTargetChanged)}else{for(let t=o.length;t--;)e.removeEventListener(o[t]+"-changed",this._onTargetChanged);o.length=0}0===o.length&&this.targets.splice(this.targets.indexOf(e),1)}}_onTargetChanged(e){if(-1===this.targets.indexOf(e.target))return void console.warn("io error: _onTargetChanged() should never fire when target is removed from binding.\n        Please file an issue at https://github.com/arodic/io/issues.");const t=e.detail.value;this.source[this.sourceProp]!==t&&(this.source[this.sourceProp]=t)}_onSourceChanged(e){if(e.target!=this.source)return void console.warn("io error: _onSourceChanged() should always originate form source node.\n        Please file an issue at https://github.com/arodic/io/issues.");const t=e.detail.value;for(let e=this.targets.length;e--;){const o=this.targetsMap.get(this.targets[e]);for(let i=o.length;i--;){let s=this.targets[e][o[i]];if(s!==t){if("number"==typeof t&&"number"==typeof s&&isNaN(t)&&isNaN(s))continue;this.targets[e][o[i]]=t}}}}dispose(){this.source.removeEventListener(this.sourceProp+"-changed",this._onSourceChanged);for(let e in this.targets)this.removeTarget(this.targets[e]),delete this.targets[e]}}class NodeQueue extends Array{constructor(e){super(),Object.defineProperty(this,"node",{value:e,configurable:!0})}queue(e,t,o){const i=this.indexOf(e);-1===i?this.push(e,{property:e,value:t,oldValue:o}):this[i+1].value=t}dispatch(){const e=this.node;if(this.length){let t=!1;for(let o=0;o<this.length;o+=2){const i=this[o],s=this[o+1],n={detail:s};s.value!==s.oldValue?(t=!0,e[i+"Changed"]&&e[i+"Changed"](n),e.dispatchEvent(i+"-changed",n.detail)):s.value}t&&(e.applyCompose(),e.changed()),this.length=0}}dispose(){this.length=0,delete this.node}}class ProtoListeners{constructor(e){for(let t=e.length;t--;){const o=e[t].constructor.listeners;for(let e in o)this[e]=o[e]}}}class Listeners{constructor(e,t){Object.defineProperty(this,"node",{value:e}),Object.defineProperty(this,"propListeners",{value:{}}),Object.defineProperty(this,"activeListeners",{value:{}});for(let e in t)this[e]=t[e]}setPropListeners(e){for(let e in this.propListeners)delete this.propListeners[e];for(let t in e)t.startsWith("on-")&&(this.propListeners[t.slice(3,t.length)]=e[t])}connect(){const e=this.node,t=this.propListeners;for(let t in this){const o="function"==typeof this[t]?this[t]:e[this[t]];e.addEventListener(t,o)}for(let o in t){const i="function"==typeof t[o]?t[o]:e[t[o]];e.addEventListener(o,i)}}disconnect(){const e=this.node,t=this.propListeners;for(let t in this){const o="function"==typeof this[t]?this[t]:e[this[t]];e.removeEventListener(t,o)}for(let o in t){const i="function"==typeof t[o]?t[o]:e[t[o]];e.removeEventListener(o,i)}}dispose(){this.disconnect();const e=this.node,t=this.activeListeners;for(let o in t)for(let i=t[o].length;i--;)e.isElement&&HTMLElement.prototype.removeEventListener.call(e,o,t[o][i]),t[o].splice(i,1)}addEventListener(e,t){const o=this.node,i=this.activeListeners;i[e]=i[e]||[],-1===i[e].indexOf(t)&&(o.isElement&&HTMLElement.prototype.addEventListener.call(o,e,t),i[e].push(t))}removeEventListener(e,t){const o=this.node,i=this.activeListeners;if(void 0!==i[e]){const s=i[e].indexOf(t);-1!==s&&(o.isElement&&HTMLElement.prototype.removeEventListener.call(o,e,t),i[e].splice(s,1))}}dispatchEvent(e,t={},o=!0,i=this.node){if(i instanceof HTMLElement||i===window)HTMLElement.prototype.dispatchEvent.call(i,new CustomEvent(e,{type:e,detail:t,bubbles:o,composed:!0,cancelable:!0}));else{const o=this.activeListeners;if(void 0!==o[e]){const s=o[e].slice(0);for(let e=0;e<s.length;e++)s[e].call(i,{detail:t,target:i,path:[i]})}}}}class ProtoProperties{constructor(e){this._p=e;const t={};for(let o=e.length;o--;){const i=e[o].constructor.attributes;for(let e in i)t[e]?Object.assign(t[e],new ProtoProperty(i[e])):t[e]=new ProtoProperty(i[e]),void 0===t[e].reflect&&(t[e].reflect=1),void 0===t[e].notify&&(t[e].notify=!1),void 0===t[e].enumerable&&(t[e].enumerable=!1);const s=e[o].constructor.properties;for(let e in s)t[e]?Object.assign(t[e],new ProtoProperty(s[e])):t[e]=new ProtoProperty(s[e]),void 0===t[e].reflect&&(t[e].reflect=0),void 0===t[e].notify&&(t[e].notify=!0),void 0===t[e].enumerable&&(t[e].enumerable=!0)}for(let e in t){"_"===e.charAt(0)&&(t[e].notify=!1,t[e].enumerable=!1),void 0===t[e].value&&(t[e].value=void 0),void 0===t[e].type&&(t[e].type=void 0),this[e]=new Property(t[e])}}}class ProtoProperty{constructor(e){const t=typeof e;null==e?e={value:e}:"function"===t?e={type:e}:"number"===t||"string"===t||"boolean"===t?e={value:e,type:e.constructor}:"object"===t?e instanceof Array?e={value:[...e],type:Array}:e instanceof Binding?e={value:e.value,binding:e}:"function"!=typeof e.type&&(void 0===e.value||null===e.value||(e.type=e.value.constructor)):console.error("Property error!",t,e),void 0!==e.value&&(this.value=e.value),void 0!==e.type&&(this.type=e.type),void 0!==e.reflect&&(this.reflect=e.reflect),void 0!==e.binding&&(this.binding=e.binding),void 0!==e.enumerable&&(this.enumerable=e.enumerable),void 0!==e.notify&&(this.notify=e.notify)}}class Properties{constructor(e,t){Object.defineProperty(this,"node",{value:e});for(let o in t)this[o]=new Property(t[o]),this[o].instantiateCustomType(),void 0!==this[o].value&&("object"==typeof this[o].value&&null!==this[o].value?(this[o].value.isNode&&this[o].value.connect(e),e.queue(o,this[o].value,void 0)):1===this[o].reflect&&this.node.setAttribute(o,this[o].value))}get(e){return this[e].value}set(e,t,o){let i=this[e].value;if(t!==i){let s=this[e].binding,n=t instanceof Binding?t:null;n&&s&&n!==s&&s.removeTarget(this.node,e),n?(n.addTarget(this.node,e),this[e].binding=n,this[e].value=t.source[t.sourceProp],t=t.source[t.sourceProp]):this[e].value=t,t&&t.isNode&&t.connect(this.node),i&&i.isNode&&i.disconnect(this.node),this[e].notify&&i!==this[e].value&&(this.node.queue(e,this[e].value,i),this.node.__connected&&!o&&this.node.queueDispatch()),1===this[e].reflect&&this.node.setAttribute(e,t)}}connect(){for(let e in this)this[e].binding&&this[e].binding.addTarget(this.node,e)}disconnect(){for(let e in this)this[e].binding&&this[e].binding.removeTarget(this.node,e)}dispose(){for(let e in this)this[e].binding&&(this[e].binding.removeTarget(this.node,e),delete this[e].binding),delete this[e]}}class Property{constructor(e){this.value=e.value,this.type=e.type,this.reflect=e.reflect,this.binding=e.binding,this.enumerable=e.enumerable,this.notify=e.notify,this.type===Array&&this.value&&(this.value=[...this.value]),this.type===Object&&this.value&&(this.value={}),void 0===this.value&&this.type&&(this.type===Boolean?this.value=!1:this.type===String?this.value="":this.type===Number?this.value=0:this.type===Array?this.value=[]:this.type===Object&&(this.value={}))}instantiateCustomType(){void 0===this.value&&this.type&&this.type!==HTMLElement&&this.type!==Function&&(this.value=new this.type)}}const IoNodeMixin=e=>{const t=class extends e{static get properties(){return{$:{type:Object,notify:!1}}}get bindings(){}constructor(e={}){super(e),Object.defineProperty(this,"__nodeBindings",{value:new NodeBindings(this)}),Object.defineProperty(this,"__nodeQueue",{value:new NodeQueue(this)}),Object.defineProperty(this,"__properties",{value:new Properties(this,this.__protoProperties)}),Object.defineProperty(this,"__listeners",{value:new Listeners(this,this.__protoListeners)});for(let e=0;e<this.__functions.length;e++)this[this.__functions[e]]=this[this.__functions[e]].bind(this);this.__listeners.setPropListeners(e,this),this.setProperties(e)}connect(e){this._owner=this._owner||[],-1===this._owner.indexOf(e)&&(this._owner.push(e),this.__connected||this.connectedCallback())}disconnect(e){-1!==this._owner.indexOf(e)&&this._owner.splice(this._owner.indexOf(e),1),0===this._owner.length&&this.__connected&&this.disconnectedCallback()}preventDefault(e){e.preventDefault()}changed(){}applyCompose(){const e=this.compose;if(e)for(let t in e)this[t].setProperties(e[t]),this[t].__listeners.setPropListeners(e[t],this)}bind(e){return this.__nodeBindings.get(e)}set(e,t,o){if(this[e]!==t||o){const o=this[e];this[e]=t,this.dispatchEvent("value-set",{property:e,value:t,oldValue:o},!1)}}setProperties(e){for(let t in e){if(void 0===this.__properties[t])continue;const o=this.__properties[t].value;this.__properties.set(t,e[t],!0);const i=this.__properties[t].value;i!==o&&this.queue(t,i,o)}if(e.style)for(let t in e.style)this.style[t]=e.style[t],this.style.setProperty(t,e.style[t]);this.__connected&&this.queueDispatch()}_onObjectMutation(e){for(let t=this.__objectProps.length;t--;){const o=this.__objectProps[t];if(this.__properties[o].value===e.detail.object)return this[o+"Mutated"]&&this[o+"Mutated"](e),this.changed(),void this.applyCompose()}}connectedCallback(){this.__listeners.connect(),this.__properties.connect(),this.__connected=!0,this.__objectProps.length&&window.addEventListener("object-mutated",this._onObjectMutation),this.queueDispatch()}disconnectedCallback(){this.__listeners.disconnect(),this.__properties.disconnect(),this.__connected=!1,this.__objectProps.length&&window.removeEventListener("object-mutated",this._onObjectMutation)}dispose(){this.__nodeQueue.dispose(),this.__nodeBindings.dispose(),this.__listeners.dispose(),this.__properties.dispose()}addEventListener(e,t){this.__listeners.addEventListener(e,t)}removeEventListener(e,t){this.__listeners.removeEventListener(e,t)}dispatchEvent(e,t,o=!1,i){this.__listeners.dispatchEvent(e,t,o,i)}queue(e,t,o){this.__nodeQueue.queue(e,t,o)}queueDispatch(){this.__nodeQueue.dispatch()}};return t.Register=Register,t},Register=function(){let e=this.prototype;const t=[];for(;e&&e.constructor!==HTMLElement&&e.constructor!==Object;)t.push(e),e=e.__proto__;Object.defineProperty(this.prototype,"isNode",{value:e.constructor!==HTMLElement}),Object.defineProperty(this.prototype,"isElement",{value:e.constructor===HTMLElement}),e=this.prototype,Object.defineProperty(e,"__protochain",{value:t}),Object.defineProperty(e,"__protoProperties",{value:new ProtoProperties(t)}),Object.defineProperty(e,"__protoListeners",{value:new ProtoListeners(t)});const o=new Set;for(let e=t.length;e--;){const i=Object.getOwnPropertyNames(t[e]);for(let e=0;e<i.length;e++)(i[e].startsWith("_on")||i[e].startsWith("on"))&&o.add(i[e])}Object.defineProperty(e,"__functions",{value:[...o]}),Object.defineProperty(e,"__objectProps",{value:[]});const i=[Boolean,String,Number,HTMLElement,Function,void 0];for(let t in e.__protoProperties){const o=e.__protoProperties[t];o.notify&&-1==i.indexOf(o.type)&&e.__objectProps.push(t)}for(let t in e.__protoProperties)Object.defineProperty(e,t,{get:function(){return this.__properties.get(t)},set:function(e){this.__properties.set(t,e)},enumerable:!!e.__protoProperties[t].enumerable,configurable:!0})};IoNodeMixin.Register=Register;class IoNode extends(IoNodeMixin(Object)){}class IoElement extends(IoNodeMixin(HTMLElement)){static get attributes(){return{tabindex:String,contenteditable:Boolean,class:String,role:String,title:String,label:String}}static get properties(){return{id:{type:String,enumerable:!1}}}static get observedAttributes(){const e=[];for(let t in this.prototype.__protoProperties)-1===this.prototype.__protoProperties[t].reflect&&e.push(t);return e}attributeChangedCallback(e,t,o){const i=this.__properties[e].type;i===Boolean?null===o?this[e]=!1:""===o&&(this[e]=!0):i===Number||i===String?this[e]=i(o):i===Object||i===Array?this[e]=JSON.parse(o):this[e]=isNaN(Number(o))?o:Number(o)}titleChanged(){this.setAttribute("aria-label",this.title||this.label)}labelChanged(){this.setAttribute("aria-label",this.title||this.label)}connectedCallback(){super.connectedCallback(),"function"==typeof this.resized&&(this.resized(),ro?ro.observe(this):window.addEventListener("resize",this.resized))}disconnectedCallback(){super.disconnectedCallback(),"function"==typeof this.resized&&(ro?ro.unobserve(this):window.removeEventListener("resize",this.resized))}dispose(){super.dispose(),delete this.parent,this.children.lenght=0}template(e,t){this.traverse(buildTree()(["root",e]).children,t||this)}traverse(e,t){const o=t.children;for(;o.length>e.length;){const e=o[o.length-1];for(let t=Array.from(e.querySelectorAll("*")).length;t--;);t.removeChild(e)}if(o.length<e.length){const i=document.createDocumentFragment();for(let t=o.length;t<e.length;t++)i.appendChild(constructElement(e[t]));t.appendChild(i)}for(let i=0;i<o.length;i++)if(o[i].localName!==e[i].name){const s=o[i];t.insertBefore(constructElement(e[i]),s);let n=Array.from(s.querySelectorAll("*"));t.removeChild(s);for(let e=n.length;e--;);}else if(o[i].removeAttribute("className"),o[i].hasOwnProperty("__properties"))o[i].setProperties(e[i].props),o[i].__listeners.setPropListeners(e[i].props,o[i]),o[i].__listeners.connect();else{for(let t in e[i].props)if("style"===t)for(let s in e[i].props.style)o[i].style.setProperty(s,e[i].props[t][s]);else"id"===t||("class"===t?o[i].className=e[i].props[t]:o[i][t]=e[i].props[t]);o[i].__listeners.setPropListeners(e[i].props,o[i]),o[i].__listeners.connect()}for(let t=0;t<e.length;t++)e[t].props.id&&(this.$[e[t].props.id]=o[t]),e[t].children&&"string"==typeof e[t].children?o[t].innerText=e[t].children:e[t].children&&"object"==typeof e[t].children&&this.traverse(e[t].children,o[t])}setAttribute(e,t){!0===t?HTMLElement.prototype.setAttribute.call(this,e,""):!1===t||""===t?this.removeAttribute(e):"string"!=typeof t&&"number"!=typeof t||this.getAttribute(e)!==String(t)&&HTMLElement.prototype.setAttribute.call(this,e,t)}focusTo(e,t){const o=t||this.getBoundingClientRect();let i=this,s=1/0,n=this.parentElement,r=0;for(;n&&r<10&&i===this;){const t=n.querySelectorAll('[tabindex="0"]');for(let n=t.length;n--;){if(!t[n].offsetParent)continue;const r=t[n].getBoundingClientRect(),l=r.x-o.x,a=r.y-o.y,h=Math.sqrt(l*l+a*a);switch(e){case"right":l>0&&h<s&&(i=t[n],s=h);break;case"left":l<0&&h<s&&(i=t[n],s=h);break;case"down":a>0&&h<s&&(i=t[n],s=h);break;case"up":a<0&&h<s&&(i=t[n],s=h)}}if(n=n.parentElement,r++,i!==this)return void i.focus()}}}const warning=document.createElement("div");let ro;function html(e){let t={string:"",vars:{}};for(let o=0;o<e.length;o++)t.string+=e[o]+(arguments[o+1]||"");let o=t.string.match(/-{2}?([a-z][a-z0-9]*)\b[^;]*;?/gi);if(o)for(let e=0;e<o.length;e++){let i=o[e].split(":");2===i.length&&(t.vars[i[0].trim()]=i[1].trim())}return t}warning.innerHTML='\nNo support for custom elements detected! <br />\nSorry, modern browser is required to view this page.<br />\nPlease try <a href="https://www.mozilla.org/en-US/firefox/new/">Firefox</a>,\n<a href="https://www.google.com/chrome/">Chrome</a> or\n<a href="https://www.apple.com/lae/safari/">Safari</a>',IoElement.Register=function(){IoNodeMixin.Register.call(this);const e=this.name.replace(/([a-z])([A-Z])/g,"$1-$2").toLowerCase();Object.defineProperty(this,"localName",{value:e}),Object.defineProperty(this.prototype,"localName",{value:e}),void 0!==window.customElements?(window.customElements.define(e,this),initStyle(this.prototype.__protochain)):document.body.insertBefore(warning,document.body.children[0])},void 0!==window.ResizeObserver&&(ro=new ResizeObserver(e=>{for(let t of e)t.target.resized()}));const constructElement=function(e){let t=window.customElements?window.customElements.get(e.name):null;if(t)return new t(e.props);let o=document.createElement(e.name);for(let t in e.props){if("style"===t)for(let i in e.props[t])o.style[i]=e.props[t][i];else"id"===t||("class"===t?o.className=e.props[t]:o[t]=e.props[t]);"name"===t&&o.setAttribute("name",e.props[t])}return Object.defineProperty(o,"__listeners",{value:new Listeners(o)}),o.__listeners.setPropListeners(e.props,o),o.__listeners.connect(),o},clense=(e,t)=>t?"string"==typeof t[0]?[...e,t]:[...e,...t]:e,buildTree=()=>e=>e&&"object"==typeof e[1]&&!Array.isArray(e[1])?{name:e[0],props:e[1],children:Array.isArray(e[2])?e[2].reduce(clense,[]).map(buildTree()):e[2]||""}:buildTree()([e[0],{},e[1]||""]);function initStyle(e){const t=e[0].constructor.name.replace(/([a-z])([A-Z])/g,"$1-$2").toLowerCase();for(let o=e.length;o--;){const i=e[o].constructor.style,s=e[o].constructor.name.replace(/([a-z])([A-Z])/g,"$1-$2").toLowerCase();if(i){i.string=i.string.replace(new RegExp("<style>","g"),""),i.string=i.string.replace(new RegExp("</style>","g"),""),i.string.match(new RegExp(/([^,{}]+)(,(?=[^}]*{)|\s*{)/,"g")).map(e=>{(e=e.trim()).startsWith("@")||e.startsWith(":host")||e.startsWith("/*")||e.startsWith("body")||console.warn(t+': CSS Selector not prefixed with ":host"! This will cause style leakage!')}),i.string=i.string.replace(new RegExp(":host","g"),t);const e=document.createElement("style");e.innerHTML=i.string,e.setAttribute("id","io-style_"+t+(s!==t?"_"+s:"")),document.head.appendChild(e)}}}const animationQueue=new Array,animate=function(){requestAnimationFrame(animate);for(let e=animationQueue.length;e--;)animationQueue[e]();animationQueue.length=0};function queueAnimation(e){-1===animationQueue.indexOf(e)&&animationQueue.push(e)}requestAnimationFrame(animate);const canvas=document.createElement("canvas"),gl=canvas.getContext("webgl",{antialias:!1,premultipliedAlpha:!1});gl.imageSmoothingEnabled=!1,gl.getExtension("OES_standard_derivatives"),gl.enable(gl.BLEND),gl.blendFunc(gl.SRC_ALPHA,gl.ONE_MINUS_SRC_ALPHA),gl.disable(gl.DEPTH_TEST);const positionBuff=gl.createBuffer();gl.bindBuffer(gl.ARRAY_BUFFER,positionBuff),gl.bufferData(gl.ARRAY_BUFFER,new Float32Array([-1,1,0,-1,-1,0,1,-1,0,1,1,0]),gl.STATIC_DRAW),gl.bindBuffer(gl.ARRAY_BUFFER,null);const uvBuff=gl.createBuffer();gl.bindBuffer(gl.ARRAY_BUFFER,uvBuff),gl.bufferData(gl.ARRAY_BUFFER,new Float32Array([0,1,0,0,1,0,1,1]),gl.STATIC_DRAW),gl.bindBuffer(gl.ARRAY_BUFFER,null);const indexBuff=gl.createBuffer();gl.bindBuffer(gl.ELEMENT_ARRAY_BUFFER,indexBuff),gl.bufferData(gl.ELEMENT_ARRAY_BUFFER,new Uint16Array([3,2,1,3,1,0]),gl.STATIC_DRAW),gl.bindBuffer(gl.ELEMENT_ARRAY_BUFFER,null),gl.bindBuffer(gl.ELEMENT_ARRAY_BUFFER,indexBuff);const shadersCache=new WeakMap;class IoQuad extends IoElement{static get style(){return html`<style>:host {display: flex;flex-direction: column;overflow: hidden;}:host > canvas {flex: 1 1 auto;user-select: none;pointer-events: none;image-rendering: pixelated;}</style>`}static get properties(){return{background:[0,0,0,1],color:[1,1,1,1],size:[0,0]}}static get vert(){return"\n      attribute vec3 position;\n      attribute vec2 uv;\n      varying vec2 vUv;\n      void main(void) {\n        vUv = uv;\n        gl_Position = vec4(position, 1.0);\n      }\n    "}static get frag(){return"\n      varying vec2 vUv;\n      void main(void) {\n        vec2 px = size * vUv;\n        px = mod(px, 8.0);\n        gl_FragColor = background;\n        if (px.x <= 1.0 || px.y <= 1.0) gl_FragColor = vec4(vUv, 0.0, 1.0);\n        if (px.x <= 1.0 && px.y <= 1.0) gl_FragColor = color;\n      }\n    "}constructor(e){super(e);let t="\n      #extension GL_OES_standard_derivatives : enable\n      precision highp float;\n    ";for(let e in this.__properties){let o=this.__properties[e].type,i=this.__properties[e].value;o===Number?t+="uniform float "+e+";\n":o===Array&&(t+="uniform vec"+i.length+" "+e+";\n")}const o=gl.createShader(gl.VERTEX_SHADER);gl.shaderSource(o,this.constructor.vert),gl.compileShader(o);const i=gl.createShader(gl.FRAGMENT_SHADER);gl.shaderSource(i,t+this.constructor.frag),gl.compileShader(i),shadersCache.has(this.constructor)?this._shader=shadersCache.get(this.constructor):(this._shader=gl.createProgram(),gl.attachShader(this._shader,o),gl.attachShader(this._shader,i),shadersCache.set(this.constructor,this._shader)),gl.linkProgram(this._shader);const s=gl.getAttribLocation(this._shader,"position");gl.bindBuffer(gl.ARRAY_BUFFER,positionBuff),gl.vertexAttribPointer(s,3,gl.FLOAT,!1,0,0),gl.enableVertexAttribArray(s);const n=gl.getAttribLocation(this._shader,"uv");gl.bindBuffer(gl.ARRAY_BUFFER,uvBuff),gl.vertexAttribPointer(n,2,gl.FLOAT,!1,0,0),gl.enableVertexAttribArray(n),this.template([["canvas",{id:"canvas"}]]),this._context2d=this.$.canvas.getContext("2d"),this._context2d.imageSmoothingEnabled=!1,this.render()}resized(){const e=this.$.canvas.getBoundingClientRect();this.size[0]=e.width,this.size[1]=e.height,this.dispatchEvent("object-mutated",{object:this.size},!1,window),this.changed()}changed(){queueAnimation(this.render.bind(this))}render(){canvas.width=Math.ceil(this.size[0])||1,canvas.height=Math.ceil(this.size[1])||1,gl.viewport(0,0,canvas.width,canvas.height),gl.clearColor(this.background[0],this.background[1],this.background[2],this.background[3]),gl.clear(gl.COLOR_BUFFER_BIT),gl.useProgram(this._shader);for(let e in this.__properties){let t=this.__properties[e].type,o=this.__properties[e].value;if(t===Number){const t=gl.getUniformLocation(this._shader,e);gl.uniform1f(t,o||0)}else if(t===Array){const t=gl.getUniformLocation(this._shader,e);switch(o.length){case 2:gl.uniform2f(t,o[0],o[1]);break;case 3:gl.uniform3f(t,o[0],o[1],o[2]);break;case 4:gl.uniform4f(t,o[0],o[1],o[2],o[3])}}}gl.drawElements(gl.TRIANGLES,6,gl.UNSIGNED_SHORT,0),this._context2d&&canvas.width&&canvas.height&&(this.$.canvas.width=Number(canvas.width),this.$.canvas.height=Number(canvas.height),this._context2d.drawImage(canvas,0,0,canvas.width,canvas.height))}}IoQuad.Register();const nodes={};let hashes={};const parseHashes=function(){return window.location.hash.substr(1).split("&").reduce(function(e,t){const o=t.split("=");return e[o[0]]=o[1],e},{})},getHashes=function(){hashes=window.location.hash.substr(1).split("&").reduce(function(e,t){const o=t.split("=");return e[o[0]]=o[1],e},{});for(let e in hashes)if(nodes[e]&&""!==nodes[e]){const t=hashes[e].replace(/%20/g," ");isNaN(t)?nodes[e].value="true"===t||"false"===t?JSON.parse(t):t:nodes[e].value=JSON.parse(t)}for(let e in nodes)nodes[e].hash&&!hashes[e]&&(nodes[e].value=nodes[e].defValue)},setHashes=function(e){let t="";for(let o in nodes)(nodes[o].hash||e)&&void 0!==nodes[o].value&&""!==nodes[o].value&&nodes[o].value!==nodes[o].defValue&&("string"==typeof nodes[o].value?t+=o+"="+nodes[o].value+"&":t+=o+"="+JSON.stringify(nodes[o].value)+"&");for(let e in hashes)e&&!nodes[e]&&(t+=e+"="+hashes[e]+"&");t=t.slice(0,-1),window.location.hash=t,window.location.hash||history.replaceState({},document.title,".")};window.addEventListener("hashchange",getHashes,!1),getHashes();class IoStorageNode extends IoNode{static get properties(){return{key:String,value:void 0,defValue:void 0,hash:Boolean}}constructor(e,t){if(super(e),this.defValue=t,this.hash)if(void 0!==hashes[this.key]){const e=hashes[this.key].replace(/%20/g," ");try{this.value=JSON.parse(e)}catch(t){this.value=e}}else this.value=t;else{const e="/"!==window.location.pathname?window.location.pathname+this.key:this.key,o=localStorage.getItem(e);this.value=null!=o?JSON.parse(o):t}}valueChanged(){if(this.hash)setHashes();else{const e="/"!==window.location.pathname?window.location.pathname+this.key:this.key;null===this.value||void 0===this.value?localStorage.removeItem(e):localStorage.setItem(e,JSON.stringify(this.value))}}}function IoStorage(e,t,o){return nodes[e]||(nodes[e]=new IoStorageNode({key:e,hash:o},t),nodes[e].binding=nodes[e].bind("value"),nodes[e].connect(window),nodes[e].valueChanged()),nodes[e].binding}IoStorageNode.Register(),"serviceWorker"in navigator||console.warn("No Service Worker support!"),"PushManager"in window||console.warn("No Push API Support!");class IoServiceLoader extends IoNode{static get properties(){return{path:"service.js",serviceWorker:void 0,permission:window.Notification?window.Notification.permission:"default",subscription:""}}constructor(e){super(e),this.requestNotification=this.requestNotification.bind(this),"serviceWorker"in navigator&&this.init()}async init(){const e=await navigator.serviceWorker.register(this.path);e.update(),navigator.serviceWorker.addEventListener("message",this.onServiceWorkerMessage),e.active?this.serviceWorker=e:e.addEventListener("activate",()=>{this.serviceWorker=e})}serviceWorkerChanged(){"granted"===this.permission&&this.subscribe()}subscribe(){navigator.serviceWorker.controller&&navigator.serviceWorker.controller.postMessage({command:"subscribe"})}async requestNotification(){this.permission=await window.Notification.requestPermission(),"granted"===this.permission&&this.subscribe()}onServiceWorkerMessage(e){const t=JSON.parse(e.data);t.subscription&&(this.subscription=JSON.stringify(t.subscription))}}IoServiceLoader.Register();class IoItem extends IoElement{static get style(){return html`<style>:host {display: inline-block;cursor: pointer;background-color: var(--io-background-color);color: var(--io-color);padding: var(--io-spacing);white-space: nowrap;-webkit-tap-highlight-color: transparent;overflow: hidden;text-overflow: ellipsis;user-select: none;}:host:hover {background-color: var(--io-background-color-light);}:host:focus {overflow: hidden;text-overflow: clip;border-color: var(--io-color-focus);outline: 0;}:host[aria-invalid] {color: var(--io-color-error);}:host[hidden] {display: none;}:host[selected] {color: var(--io-color-link);}</style>`}static get attributes(){return{label:{notify:!0},hidden:Boolean,selected:Boolean,tabindex:0}}static get properties(){return{value:void 0}}static get listeners(){return{focus:"_onFocus",touchstart:"_onTouchstart",mousedown:"_onMousedown"}}disconnectedCallback(){super.disconnectedCallback(),this.removeEventListener("blur",this._onBlur),this.removeEventListener("keydown",this._onKeydown),this.removeEventListener("click",this._onClick)}_onTouchstart(){}_onMousedown(){this.focus()}_onFocus(){this.addEventListener("blur",this._onBlur),this.addEventListener("keydown",this._onKeydown),this.addEventListener("click",this._onClick)}_onBlur(){this.removeEventListener("blur",this._onBlur),this.removeEventListener("keydown",this._onKeydown),this.removeEventListener("click",this._onClick)}_onKeydown(e){13===e.which||32===e.which?(e.preventDefault(),this._onClick(e)):"ArrowLeft"===e.key?(e.preventDefault(),this.focusTo("left")):"ArrowUp"===e.key?(e.preventDefault(),this.focusTo("up")):"ArrowRight"===e.key?(e.preventDefault(),this.focusTo("right")):"ArrowDown"===e.key&&(e.preventDefault(),this.focusTo("down"))}_onClick(){this.dispatchEvent("item-clicked",{value:this.value,label:this.label},!0)}changed(){let e=String(this.value);this.value&&"object"==typeof this.value&&(e=`${this.value.constructor.name}`+(this.value instanceof Array?`(${this.value.length})`:"")),this.title=this.label||e,this.innerText=this.label||e}}IoItem.Register();class IoButton extends IoItem{static get style(){return html`<style>:host {background-color: var(--io-background-color-dark);background-image: var(--io-gradient-button);border: var(--io-outset-border);border-color: var(--io-outset-border-color);border-radius: var(--io-border-radius);padding: var(--io-spacing);padding-left: calc(3 * var(--io-spacing));padding-right: calc(3 * var(--io-spacing));transition: background-color 0.4s;}</style>`}static get attributes(){return{label:"Button",role:"button"}}static get properties(){return{action:Function,value:void 0}}_onClick(){this.action&&this.action(this.value)}}IoButton.Register();class IoBoolean extends IoButton{static get style(){return html`<style>:host {border: var(--io-outset-border);border-color: var(--io-outset-border-color);color: var(--io-color-field);background-color: var(--io-background-color-field);}:host[aria-invalid] {color: var(--io-color-error);}</style>`}static get properties(){return{value:{type:Boolean,reflect:1},true:"true",false:"false",role:"switch"}}constructor(e){super(e),this.__properties.action.value=this.toggle}toggle(){this.set("value",!this.value)}changed(){this.setAttribute("aria-checked",String(this.value)),this.setAttribute("aria-invalid","boolean"!=typeof this.value&&"true"),this.innerText=this.value?this.true:this.false}}IoBoolean.Register();class IoBreadcrumbs extends IoElement{static get style(){return html`<style>:host {display: flex;flex: 1 0 auto;flex-direction: row;align-self: stretch;border-radius: var(--io-border-radius);border: var(--io-inset-border);border-color: var(--io-inset-border-color);padding: var(--io-spacing);color: var(--io-color-field);background-color: var(--io-background-color-field);padding: var(--io-spacing);}:host > io-button {border: none;overflow: hidden;text-overflow: ellipsis;background: none;padding: 0 var(--io-spacing);}:host > io-button:hover {text-decoration: underline;}:host > io-button:first-of-type {color: var(--io-color);overflow: visible;text-overflow: clip;margin-left: var(--io-spacing);}:host > io-button:last-of-type {overflow: visible;text-overflow: clip;margin-right: var(--io-spacing);}:host > io-button:not(:first-of-type):before {content: '>';margin: 0 var(--io-spacing);padding: 0 var(--io-spacing) 0 0;opacity: 0.25;}</style>`}static get properties(){return{value:null,options:Array,trim:Boolean}}_onClick(e){this.set("value",e.value),this.trim&&(this.options.length=e.index+1,this.dispatchEvent("object-mutated",{object:this.options},!1,window))}changed(){const e=this.options.map(e=>void 0!==e.label||void 0!==e.value?e:{value:e});this.template([e.map((e,t)=>["io-button",{action:this._onClick,value:{index:t,value:e.value},label:e.label||e.value}])])}}IoBreadcrumbs.Register();class IoCollapsable extends IoElement{static get style(){return html`<style>:host {display: flex;flex-direction: column;align-self: stretch;border: var(--io-outset-border);border-radius: var(--io-border-radius);border-color: var(--io-outset-border-color);padding: var(--io-spacing);background: var(--io-background-color-dark);background-image: var(--io-gradient-collapsable);transition: background-color 0.4s;}:host > io-boolean {color: var(--io-color);border-color: transparent;background: none;padding: 0;padding-right: 0.5em !important;;}:host > io-boolean:hover {background: none;border-image: none;}:host > io-boolean::before {display: inline-block;content: '▸';line-height: 1em;width: 0.5em;padding: 0 0.5em 0 0;}:host[expanded] > io-boolean::before{content: '▾';}:host > .io-content {display: flex;flex-direction: column;overflow: auto;border-radius: var(--io-border-radius);border: var(--io-inset-border);border-color: var(--io-inset-border-color);padding: var(--io-spacing);background: var(--io-background-color);}:host:not([expanded]) > .io-content {display: none;}</style>`}static get attributes(){return{label:{notify:!0},expanded:{type:Boolean,notify:!0},role:"region"}}static get properties(){return{elements:Array}}_onButtonValueSet(e){this.set("expanded",e.detail.value)}changed(){this.template([["io-boolean",{true:this.label,false:this.label,value:this.expanded,"on-value-set":this._onButtonValueSet}],["div",{id:"content",class:"io-content"},this.expanded&&this.elements.length?this.elements:[null]]]),this.children[0].setAttribute("aria-expanded",String(this.expanded))}}IoCollapsable.Register();class IoElementDemo extends IoElement{static get style(){return html`<style>:host {display: flex;flex-direction: column;position: relative;border: var(--io-inset-border);border-color: var(--io-inset-border-color);background: rgba(0, 0, 0, 0.125);}:host > .demo-tag {margin: var(--io-spacing);margin-bottom: 0;}:host > io-properties {margin-left: 0.5em;}:host > .io-content {display: flex;flex-direction: column;align-items: flex-start;padding: var(--io-spacing);min-height: 1.2em;background: rgba(255, 255, 255, 0.125);}</style>`}static get attributes(){return{element:{type:String,reflect:-1,notify:!0},properties:{type:Object,reflect:-1,notify:!0},config:{type:Object,reflect:-1,notify:!0}}}static get properties(){return{_properties:Object}}_onPropSet(e){this.properties[e.detail.property]=e.detail.value,this.dispatchEvent("object-mutated",{object:this.properties,property:e.detail.property,value:e.detail.value,oldValue:e.detail.oldValue},!1,window)}_onObjectMutation(e){super._onObjectMutation(e);for(let t in this.properties)"object"==typeof this.properties[t]&&this._bubbleMutation(this.properties[t],this.properties,e.detail.object)}_bubbleMutation(e,t,o){if(e===o)this.dispatchEvent("object-mutated",{object:t},!1,window);else for(let t in e)"object"==typeof e[t]&&this._bubbleMutation(e[t],e,o)}changed(){for(let e in this.properties)"undefined"===this.properties[e]&&(this.properties[e]=void 0);this.element?this.template([["div",{class:"demo-tag"},"<"+this.element+">"],["io-properties",{value:this.properties,config:this.config}],["div",{class:"io-content"},[[this.element,Object.assign({"on-value-set":this._onPropSet},this.properties)]]]]):this.template([null])}}IoElementDemo.Register();class Options extends Array{constructor(e){super(...e.map?e.map(e=>new Option(e)):[])}}class Option{constructor(e){"object"!=typeof e||void 0===e.options&&void 0===e.action&&void 0===e.value?this.value=e:(Object.assign(this,e),this.options&&this.options.length&&(this.options instanceof Options||(this.options=new Options(this.options)))),void 0===this.label&&(this.value instanceof Array?this.label=String(`${this.value.constructor.name} (${this.value.length})`):"object"==typeof this.value?this.label=String(`${this.value.constructor.name}`):void 0!==this.value?this.label=String(this.value):console.warn("Option must have label or value!"))}}function isValuePropertyOf(e,t){for(let o in t)if(t[o]===e)return o;return null}function filterObject(e,t){if(t(e))return e;for(let o in e){if(t(e[o]))return e[o];if("object"==typeof e[o]){const i=filterObject(e[o],t);if(i)return i}}}class IoInspector extends IoElement{static get style(){return html`<style>:host {display: flex;flex-direction: column;align-self: stretch;border: var(--io-border);border-radius: var(--io-border-radius);padding: var(--io-spacing);background: var(--io-background-color);}:host > io-breadcrumbs {margin-bottom: var(--io-spacing);}:host > io-collapsable > .io-content {padding: 0;}:host io-properties > .io-property {overflow: hidden;background-color: var(--io-background-color);padding: var(--io-spacing) 0;}:host io-properties > .io-property:nth-child(2n) {background-color: var(--io-background-color-light);}:host io-properties > .io-property > * {overflow: hidden;text-overflow: ellipsis;white-space: nowrap;}:host io-properties > .io-property > :nth-child(1) {text-align: right;flex: 0 1 8em;min-width: 3em;}:host io-properties > .io-property > :nth-child(2) {flex: 1 1 8em;min-width: 3em;margin: 0 var(--io-spacing);}:host io-number,:host io-string {border-color: var(--io-inset-border-color) !important;color: var(--io-color-field) !important;background: var(--io-background-color-field) !important;padding: 0 var(--io-spacing) !important;}:host io-properties > .io-property > io-properties {border: var(--io-inset-border);border-radius: var(--io-border-radius);}:host io-item {color: var(--io-color-link);}:host io-item:hover {text-decoration: underline;}</style>`}static get properties(){return{value:Object,config:Object,_options:Array}}static get listeners(){return{"item-clicked":"_onSetInspectorValue"}}get groups(){return this.__proto__.__config.getConfig(this.value,this.config)}_onSetInspectorValue(e){e.stopImmediatePropagation(),this.set("value",e.detail.value)}_onBreadcrumbsValue(e){this.set("value",e.detail.value)}valueChanged(){if(!this._options.find(e=>e.value===this.value)){const e=this._options[this._options.length-1];e&&isValuePropertyOf(this.value,e.value)||(this._options.length=0),this._options.push(new Option(this.value)),this.dispatchEvent("object-mutated",{object:this._options},!1,window)}}changed(){const e=[["io-breadcrumbs",{value:this.value,options:this._options,trim:!0,"on-value-set":this._onBreadcrumbsValue}]];let t=this.value.constructor.name;t+=this.value.guid||this.value.uuid||this.value.id||"";for(let o in this.groups)e.push(["io-collapsable",{label:o,expanded:IoStorage("io-inspector-group-"+t+"-"+o,!0),elements:[["io-properties",{value:this.value,properties:this.groups[o],config:Object.assign({"type:object":["io-item"]},this.config)}]]}]);this.template(e)}static get config(){return{"Object|hidden":[/^_/],"HTMLElement|hidden":[/^_/,"innerText","outerText","innerHTML","outerHTML","textContent"]}}}class Config{constructor(e){for(let t=0;t<e.length;t++)this.registerConfig(e[t].constructor.config||{})}registerConfig(e){for(let t in e)this[t]=this[t]||[],this[t]=[...this[t],...e[t]]}getConfig(e,t){const o=Object.keys(e),i=[];let s=e.__proto__;for(;s;)o.push(...Object.keys(s)),i.push(s.constructor.name),s=s.__proto__;const n={};for(let e in this){const t=e.split("|");1===t.length&&t.splice(0,0,"Object"),-1!==i.indexOf(t[0])&&(n[t[1]]=n[t[1]]||[],n[t[1]].push(...this[e]))}for(let e in t){const o=e.split("|");1===o.length&&o.splice(0,0,"Object"),-1!==i.indexOf(o[0])&&(n[o[1]]=n[o[1]]||[],n[o[1]].push(t[e]))}const r={},l=[];for(let e in n){r[e]=r[e]||[];for(let t in n[e]){const i=n[e][t],s=new RegExp(i);for(let t=0;t<o.length;t++){const n=o[t];"string"==typeof i?n==i&&(r[e].push(n),l.push(n)):"object"==typeof i&&s.exec(n)&&(r[e].push(n),l.push(n))}}}if(0===l.length)r.properties=o;else for(let e=0;e<o.length;e++)r.properties=r.properties||[],-1===l.indexOf(o[e])&&r.properties.push(o[e]);for(let e in r)0===r[e].length&&delete r[e];return delete r.hidden,r}}IoInspector.Register=function(){IoElement.Register.call(this),Object.defineProperty(this.prototype,"__config",{value:new Config(this.prototype.__protochain)})},IoInspector.Register();class IoLayout extends IoElement{static get style(){return html`<style>:host {flex: 1;display: flex;overflow: hidden;touch-action: none;/* border: var(--io-outset-border); *//* border-color: var(--io-outset-border-color); */}:host[orientation=horizontal] {flex-direction: row;}:host[orientation=vertical] {flex-direction: column;}</style>`}static get attributes(){return{orientation:{value:"horizontal",notify:!0}}}static get properties(){return{elements:Array,splits:Array,editable:!0}}static get listeners(){return{"io-layout-divider-move":"_onDividerMove","io-layout-tab-insert":"_onLayoutTabInsert"}}_onSelectedChanged(){const e=[].slice.call(this.children).filter(e=>"io-layout-divider"!==e.localName);for(let t=0;t<e.length;t++)e[t].selected&&(this.splits[t].selected=e[t].selected)}changed(){let e=[];for(let t=0;t<this.splits.length;t++){const o=this.splits[t],i=void 0!==o.size?o.size+"px":null,s={"flex-basis":i||"auto","flex-grow":i?0:1,"flex-shrink":i?0:1};o.tabs?e.push(["io-selector-tabs",{elements:this.elements,filter:o.tabs,selected:o.selected,editable:this.editable,style:s,"on-selected-changed":this._onSelectedChanged}]):o.splits?e.push(["io-layout",{elements:this.elements,splits:o.splits,orientation:o.orientation,editable:this.editable,style:s}]):e.push(["p","Malformed layout data."]),t<this.splits.length-1&&e.push(["io-layout-divider",{orientation:this.orientation||"horizontal",index:t}])}this.template([e])}_onLayoutTabInsert(e){e.stopImmediatePropagation();const t=[].slice.call(this.children).filter(e=>"io-layout-divider"!==e.localName),o=e.detail.source,i=e.detail.destination,s=t.indexOf(i),n=e.detail.tab,r="vertical"===this.orientation,l=e.detail.direction;for(let e=o.filter.length;e--;)o.filter[e]===n&&(o.filter.splice(e,1),o.selected=o.filter[o.filter.length-1],o.changed());r&&"down"===l||!r&&"right"===l?this.splits.splice(s+1,0,{tabs:[n],selected:n}):r&&"up"===l||!r&&"left"===l?this.splits.splice(s,0,{tabs:[n],selected:n}):r&&"left"===l||!r&&"up"===l?this.splits[s]={splits:[{tabs:[n],selected:n},this.splits[s]],orientation:r?"horizontal":"vertical"}:(r&&"right"===l||!r&&"down"===l)&&(this.splits[s]={splits:[this.splits[s],{tabs:[n],selected:n}],orientation:r?"horizontal":"vertical"}),this.changed()}_onDividerMove(e){e.stopImmediatePropagation();let t=e.detail.index,o=e.detail.index+1,i=this.splits[t],s=this.splits[o],n=void 0===i.size?void 0:i.size+e.detail.movement,r=void 0===s.size?void 0:s.size-e.detail.movement;if(void 0!==n&&n>=0&&(void 0===r||r>=0)&&(this.splits[t].size=Math.max(0,n)),void 0!==r&&r>=0&&(void 0===n||n>=0)&&(this.splits[o].size=Math.max(0,r)),void 0===i.size&&void 0===s.size){const e=[].slice.call(this.children).filter(e=>"io-layout-divider"!==e.localName);let i="horizontal"===this.orientation?"width":"height",s=Math.floor(this.splits.length/2);if(Math.abs(s-t)<=Math.abs(s-o))for(let t=o;t<this.splits.length;t++)this.splits[t].size=parseInt(e[t].getBoundingClientRect()[i]);else for(let o=t;o>=0;o--)this.splits[o].size=parseInt(e[o].getBoundingClientRect()[i])}this.queue("splits",this.splits,this.splits),this.queueDispatch()}}IoLayout.Register();class IoLayoutDivider extends IoElement{static get style(){return html`<style>:host {background: var(--io-background-color);color: var(--io-color);z-index: 1;display: flex;flex: none;border: var(--io-outset-border);border-color: var(--io-outset-border-color);user-select: none;transition: background-color 0.4s;}:host:hover {background-color: var(--io-color-focus);}:host[orientation=horizontal] {cursor: col-resize;width: var(--io-spacing);border-top: 0;border-bottom: 0;}:host[orientation=vertical] {cursor: row-resize;height: var(--io-spacing);border-left: 0;border-right: 0;}:host > .app-divider {flex: 1;display: flex;margin-left: -0.03em;margin-top: -0.06em;align-items: center;justify-content: center;}</style>`}static get properties(){return{orientation:{value:"horizontal",reflect:1},index:Number,pointermode:"relative"}}static get listeners(){return{pointermove:"_onPointerMove"}}_onPointerMove(e){e.buttons&&(e.preventDefault(),this.setPointerCapture(e.pointerId),this.dispatchEvent("io-layout-divider-move",{movement:"horizontal"===this.orientation?e.movementX:e.movementY,index:this.index},!0))}changed(){this.template([["div",{class:"app-divider"},"horizontal"===this.orientation?"⋮":"⋯"]])}}IoLayoutDivider.Register(),function(e){var t={newline:/^\n+/,code:/^( {4}[^\n]+\n*)+/,fences:g,hr:/^ {0,3}((?:- *){3,}|(?:_ *){3,}|(?:\* *){3,})(?:\n+|$)/,heading:/^ *(#{1,6}) *([^\n]+?) *(?:#+ *)?(?:\n+|$)/,nptable:g,blockquote:/^( {0,3}> ?(paragraph|[^\n]*)(?:\n|$))+/,list:/^( *)(bull) [\s\S]+?(?:hr|def|\n{2,}(?! )(?!\1bull )\n*|\s*$)/,html:"^ {0,3}(?:<(script|pre|style)[\\s>][\\s\\S]*?(?:</\\1>[^\\n]*\\n+|$)|comment[^\\n]*(\\n+|$)|<\\?[\\s\\S]*?\\?>\\n*|<![A-Z][\\s\\S]*?>\\n*|<!\\[CDATA\\[[\\s\\S]*?\\]\\]>\\n*|</?(tag)(?: +|\\n|/?>)[\\s\\S]*?(?:\\n{2,}|$)|<(?!script|pre|style)([a-z][\\w-]*)(?:attribute)*? */?>(?=\\h*\\n)[\\s\\S]*?(?:\\n{2,}|$)|</(?!script|pre|style)[a-z][\\w-]*\\s*>(?=\\h*\\n)[\\s\\S]*?(?:\\n{2,}|$))",def:/^ {0,3}\[(label)\]: *\n? *<?([^\s>]+)>?(?:(?: +\n? *| *\n *)(title))? *(?:\n+|$)/,table:g,lheading:/^([^\n]+)\n *(=|-){2,} *(?:\n+|$)/,paragraph:/^([^\n]+(?:\n(?!hr|heading|lheading| {0,3}>|<\/?(?:tag)(?: +|\n|\/?>)|<(?:script|pre|style|!--))[^\n]+)*)/,text:/^[^\n]+/};function o(e){this.tokens=[],this.tokens.links=Object.create(null),this.options=e||m.defaults,this.rules=t.normal,this.options.pedantic?this.rules=t.pedantic:this.options.gfm&&(this.options.tables?this.rules=t.tables:this.rules=t.gfm)}t._label=/(?!\s*\])(?:\\[\[\]]|[^\[\]])+/,t._title=/(?:"(?:\\"?|[^"\\])*"|'[^'\n]*(?:\n[^'\n]+)*\n?'|\([^()]*\))/,t.def=c(t.def).replace("label",t._label).replace("title",t._title).getRegex(),t.bullet=/(?:[*+-]|\d+\.)/,t.item=/^( *)(bull) [^\n]*(?:\n(?!\1bull )[^\n]*)*/,t.item=c(t.item,"gm").replace(/bull/g,t.bullet).getRegex(),t.list=c(t.list).replace(/bull/g,t.bullet).replace("hr","\\n+(?=\\1?(?:(?:- *){3,}|(?:_ *){3,}|(?:\\* *){3,})(?:\\n+|$))").replace("def","\\n+(?="+t.def.source+")").getRegex(),t._tag="address|article|aside|base|basefont|blockquote|body|caption|center|col|colgroup|dd|details|dialog|dir|div|dl|dt|fieldset|figcaption|figure|footer|form|frame|frameset|h[1-6]|head|header|hr|html|iframe|legend|li|link|main|menu|menuitem|meta|nav|noframes|ol|optgroup|option|p|param|section|source|summary|table|tbody|td|tfoot|th|thead|title|tr|track|ul",t._comment=/<!--(?!-?>)[\s\S]*?-->/,t.html=c(t.html,"i").replace("comment",t._comment).replace("tag",t._tag).replace("attribute",/ +[a-zA-Z:_][\w.:-]*(?: *= *"[^"\n]*"| *= *'[^'\n]*'| *= *[^\s"'=<>`]+)?/).getRegex(),t.paragraph=c(t.paragraph).replace("hr",t.hr).replace("heading",t.heading).replace("lheading",t.lheading).replace("tag",t._tag).getRegex(),t.blockquote=c(t.blockquote).replace("paragraph",t.paragraph).getRegex(),t.normal=v({},t),t.gfm=v({},t.normal,{fences:/^ *(`{3,}|~{3,})[ \.]*(\S+)? *\n([\s\S]*?)\n? *\1 *(?:\n+|$)/,paragraph:/^/,heading:/^ *(#{1,6}) +([^\n]+?) *#* *(?:\n+|$)/}),t.gfm.paragraph=c(t.paragraph).replace("(?!","(?!"+t.gfm.fences.source.replace("\\1","\\2")+"|"+t.list.source.replace("\\1","\\3")+"|").getRegex(),t.tables=v({},t.gfm,{nptable:/^ *([^|\n ].*\|.*)\n *([-:]+ *\|[-| :]*)(?:\n((?:.*[^>\n ].*(?:\n|$))*)\n*|$)/,table:/^ *\|(.+)\n *\|?( *[-:]+[-| :]*)(?:\n((?: *[^>\n ].*(?:\n|$))*)\n*|$)/}),t.pedantic=v({},t.normal,{html:c("^ *(?:comment *(?:\\n|\\s*$)|<(tag)[\\s\\S]+?</\\1> *(?:\\n{2,}|\\s*$)|<tag(?:\"[^\"]*\"|'[^']*'|\\s[^'\"/>\\s]*)*?/?> *(?:\\n{2,}|\\s*$))").replace("comment",t._comment).replace(/tag/g,"(?!(?:a|em|strong|small|s|cite|q|dfn|abbr|data|time|code|var|samp|kbd|sub|sup|i|b|u|mark|ruby|rt|rp|bdi|bdo|span|br|wbr|ins|del|img)\\b)\\w+(?!:|[^\\w\\s@]*@)\\b").getRegex(),def:/^ *\[([^\]]+)\]: *<?([^\s>]+)>?(?: +(["(][^\n]+[")]))? *(?:\n+|$)/}),o.rules=t,o.lex=function(e,t){return new o(t).lex(e)},o.prototype.lex=function(e){return e=e.replace(/\r\n|\r/g,"\n").replace(/\t/g,"    ").replace(/\u00a0/g," ").replace(/\u2424/g,"\n"),this.token(e,!0)},o.prototype.token=function(e,o){var i,s,n,r,l,a,h,c,d,u,p,g,v,m,_,y;for(e=e.replace(/^ +$/gm,"");e;)if((n=this.rules.newline.exec(e))&&(e=e.substring(n[0].length),1<n[0].length&&this.tokens.push({type:"space"})),n=this.rules.code.exec(e))e=e.substring(n[0].length),n=n[0].replace(/^ {4}/gm,""),this.tokens.push({type:"code",text:this.options.pedantic?n:b(n,"\n")});else if(n=this.rules.fences.exec(e))e=e.substring(n[0].length),this.tokens.push({type:"code",lang:n[2],text:n[3]||""});else if(n=this.rules.heading.exec(e))e=e.substring(n[0].length),this.tokens.push({type:"heading",depth:n[1].length,text:n[2]});else if(o&&(n=this.rules.nptable.exec(e))&&(a={type:"table",header:f(n[1].replace(/^ *| *\| *$/g,"")),align:n[2].replace(/^ *|\| *$/g,"").split(/ *\| */),cells:n[3]?n[3].replace(/\n$/,"").split("\n"):[]}).header.length===a.align.length){for(e=e.substring(n[0].length),p=0;p<a.align.length;p++)/^ *-+: *$/.test(a.align[p])?a.align[p]="right":/^ *:-+: *$/.test(a.align[p])?a.align[p]="center":/^ *:-+ *$/.test(a.align[p])?a.align[p]="left":a.align[p]=null;for(p=0;p<a.cells.length;p++)a.cells[p]=f(a.cells[p],a.header.length);this.tokens.push(a)}else if(n=this.rules.hr.exec(e))e=e.substring(n[0].length),this.tokens.push({type:"hr"});else if(n=this.rules.blockquote.exec(e))e=e.substring(n[0].length),this.tokens.push({type:"blockquote_start"}),n=n[0].replace(/^ *> ?/gm,""),this.token(n,o),this.tokens.push({type:"blockquote_end"});else if(n=this.rules.list.exec(e)){for(e=e.substring(n[0].length),h={type:"list_start",ordered:m=1<(r=n[2]).length,start:m?+r:"",loose:!1},this.tokens.push(h),i=!(c=[]),v=(n=n[0].match(this.rules.item)).length,p=0;p<v;p++)u=(a=n[p]).length,~(a=a.replace(/^ *([*+-]|\d+\.) +/,"")).indexOf("\n ")&&(u-=a.length,a=this.options.pedantic?a.replace(/^ {1,4}/gm,""):a.replace(new RegExp("^ {1,"+u+"}","gm"),"")),this.options.smartLists&&p!==v-1&&(r===(l=t.bullet.exec(n[p+1])[0])||1<r.length&&1<l.length||(e=n.slice(p+1).join("\n")+e,p=v-1)),s=i||/\n\n(?!\s*$)/.test(a),p!==v-1&&(i="\n"===a.charAt(a.length-1),s||(s=i)),s&&(h.loose=!0),y=void 0,(_=/^\[[ xX]\] /.test(a))&&(y=" "!==a[1],a=a.replace(/^\[[ xX]\] +/,"")),d={type:"list_item_start",task:_,checked:y,loose:s},c.push(d),this.tokens.push(d),this.token(a,!1),this.tokens.push({type:"list_item_end"});if(h.loose)for(v=c.length,p=0;p<v;p++)c[p].loose=!0;this.tokens.push({type:"list_end"})}else if(n=this.rules.html.exec(e))e=e.substring(n[0].length),this.tokens.push({type:this.options.sanitize?"paragraph":"html",pre:!this.options.sanitizer&&("pre"===n[1]||"script"===n[1]||"style"===n[1]),text:n[0]});else if(o&&(n=this.rules.def.exec(e)))e=e.substring(n[0].length),n[3]&&(n[3]=n[3].substring(1,n[3].length-1)),g=n[1].toLowerCase().replace(/\s+/g," "),this.tokens.links[g]||(this.tokens.links[g]={href:n[2],title:n[3]});else if(o&&(n=this.rules.table.exec(e))&&(a={type:"table",header:f(n[1].replace(/^ *| *\| *$/g,"")),align:n[2].replace(/^ *|\| *$/g,"").split(/ *\| */),cells:n[3]?n[3].replace(/(?: *\| *)?\n$/,"").split("\n"):[]}).header.length===a.align.length){for(e=e.substring(n[0].length),p=0;p<a.align.length;p++)/^ *-+: *$/.test(a.align[p])?a.align[p]="right":/^ *:-+: *$/.test(a.align[p])?a.align[p]="center":/^ *:-+ *$/.test(a.align[p])?a.align[p]="left":a.align[p]=null;for(p=0;p<a.cells.length;p++)a.cells[p]=f(a.cells[p].replace(/^ *\| *| *\| *$/g,""),a.header.length);this.tokens.push(a)}else if(n=this.rules.lheading.exec(e))e=e.substring(n[0].length),this.tokens.push({type:"heading",depth:"="===n[2]?1:2,text:n[1]});else if(o&&(n=this.rules.paragraph.exec(e)))e=e.substring(n[0].length),this.tokens.push({type:"paragraph",text:"\n"===n[1].charAt(n[1].length-1)?n[1].slice(0,-1):n[1]});else if(n=this.rules.text.exec(e))e=e.substring(n[0].length),this.tokens.push({type:"text",text:n[0]});else if(e)throw new Error("Infinite loop on byte: "+e.charCodeAt(0));return this.tokens};var i={escape:/^\\([!"#$%&'()*+,\-./:;<=>?@\[\]\\^_`{|}~])/,autolink:/^<(scheme:[^\s\x00-\x1f<>]*|email)>/,url:g,tag:"^comment|^</[a-zA-Z][\\w:-]*\\s*>|^<[a-zA-Z][\\w-]*(?:attribute)*?\\s*/?>|^<\\?[\\s\\S]*?\\?>|^<![a-zA-Z]+\\s[\\s\\S]*?>|^<!\\[CDATA\\[[\\s\\S]*?\\]\\]>",link:/^!?\[(label)\]\(href(?:\s+(title))?\s*\)/,reflink:/^!?\[(label)\]\[(?!\s*\])((?:\\[\[\]]?|[^\[\]\\])+)\]/,nolink:/^!?\[(?!\s*\])((?:\[[^\[\]]*\]|\\[\[\]]|[^\[\]])*)\](?:\[\])?/,strong:/^__([^\s])__(?!_)|^\*\*([^\s])\*\*(?!\*)|^__([^\s][\s\S]*?[^\s])__(?!_)|^\*\*([^\s][\s\S]*?[^\s])\*\*(?!\*)/,em:/^_([^\s_])_(?!_)|^\*([^\s*"<\[])\*(?!\*)|^_([^\s][\s\S]*?[^\s_])_(?!_)|^_([^\s_][\s\S]*?[^\s])_(?!_)|^\*([^\s"<\[][\s\S]*?[^\s*])\*(?!\*)|^\*([^\s*"<\[][\s\S]*?[^\s])\*(?!\*)/,code:/^(`+)([^`]|[^`][\s\S]*?[^`])\1(?!`)/,br:/^( {2,}|\\)\n(?!\s*$)/,del:g,text:/^(`+|[^`])[\s\S]*?(?=[\\<!\[`*]|\b_| {2,}\n|$)/};function s(e,t){if(this.options=t||m.defaults,this.links=e,this.rules=i.normal,this.renderer=this.options.renderer||new n,this.renderer.options=this.options,!this.links)throw new Error("Tokens array requires a `links` property.");this.options.pedantic?this.rules=i.pedantic:this.options.gfm&&(this.options.breaks?this.rules=i.breaks:this.rules=i.gfm)}function n(e){this.options=e||m.defaults}function r(){}function l(e){this.tokens=[],this.token=null,this.options=e||m.defaults,this.options.renderer=this.options.renderer||new n,this.renderer=this.options.renderer,this.renderer.options=this.options}function a(e,t){if(t){if(a.escapeTest.test(e))return e.replace(a.escapeReplace,function(e){return a.replacements[e]})}else if(a.escapeTestNoEncode.test(e))return e.replace(a.escapeReplaceNoEncode,function(e){return a.replacements[e]});return e}function h(e){return e.replace(/&(#(?:\d+)|(?:#x[0-9A-Fa-f]+)|(?:\w+));?/gi,function(e,t){return"colon"===(t=t.toLowerCase())?":":"#"===t.charAt(0)?"x"===t.charAt(1)?String.fromCharCode(parseInt(t.substring(2),16)):String.fromCharCode(+t.substring(1)):""})}function c(e,t){return e=e.source||e,t=t||"",{replace:function(t,o){return o=(o=o.source||o).replace(/(^|[^\[])\^/g,"$1"),e=e.replace(t,o),this},getRegex:function(){return new RegExp(e,t)}}}function d(e,t){return u[" "+e]||(/^[^:]+:\/*[^/]*$/.test(e)?u[" "+e]=e+"/":u[" "+e]=b(e,"/",!0)),e=u[" "+e],"//"===t.slice(0,2)?e.replace(/:[\s\S]*/,":")+t:"/"===t.charAt(0)?e.replace(/(:\/*[^/]*)[\s\S]*/,"$1")+t:e+t}i._escapes=/\\([!"#$%&'()*+,\-./:;<=>?@\[\]\\^_`{|}~])/g,i._scheme=/[a-zA-Z][a-zA-Z0-9+.-]{1,31}/,i._email=/[a-zA-Z0-9.!#$%&'*+/=?^_`{|}~-]+(@)[a-zA-Z0-9](?:[a-zA-Z0-9-]{0,61}[a-zA-Z0-9])?(?:\.[a-zA-Z0-9](?:[a-zA-Z0-9-]{0,61}[a-zA-Z0-9])?)+(?![-_])/,i.autolink=c(i.autolink).replace("scheme",i._scheme).replace("email",i._email).getRegex(),i._attribute=/\s+[a-zA-Z:_][\w.:-]*(?:\s*=\s*"[^"]*"|\s*=\s*'[^']*'|\s*=\s*[^\s"'=<>`]+)?/,i.tag=c(i.tag).replace("comment",t._comment).replace("attribute",i._attribute).getRegex(),i._label=/(?:\[[^\[\]]*\]|\\[\[\]]?|`[^`]*`|[^\[\]\\])*?/,i._href=/\s*(<(?:\\[<>]?|[^\s<>\\])*>|(?:\\[()]?|\([^\s\x00-\x1f\\]*\)|[^\s\x00-\x1f()\\])*?)/,i._title=/"(?:\\"?|[^"\\])*"|'(?:\\'?|[^'\\])*'|\((?:\\\)?|[^)\\])*\)/,i.link=c(i.link).replace("label",i._label).replace("href",i._href).replace("title",i._title).getRegex(),i.reflink=c(i.reflink).replace("label",i._label).getRegex(),i.normal=v({},i),i.pedantic=v({},i.normal,{strong:/^__(?=\S)([\s\S]*?\S)__(?!_)|^\*\*(?=\S)([\s\S]*?\S)\*\*(?!\*)/,em:/^_(?=\S)([\s\S]*?\S)_(?!_)|^\*(?=\S)([\s\S]*?\S)\*(?!\*)/,link:c(/^!?\[(label)\]\((.*?)\)/).replace("label",i._label).getRegex(),reflink:c(/^!?\[(label)\]\s*\[([^\]]*)\]/).replace("label",i._label).getRegex()}),i.gfm=v({},i.normal,{escape:c(i.escape).replace("])","~|])").getRegex(),_extended_email:/[A-Za-z0-9._+-]+(@)[a-zA-Z0-9-_]+(?:\.[a-zA-Z0-9-_]*[a-zA-Z0-9])+(?![-_])/,url:/^((?:ftp|https?):\/\/|www\.)(?:[a-zA-Z0-9\-]+\.?)+[^\s<]*|^email/,_backpedal:/(?:[^?!.,:;*_~()&]+|\([^)]*\)|&(?![a-zA-Z0-9]+;$)|[?!.,:;*_~)]+(?!$))+/,del:/^~+(?=\S)([\s\S]*?\S)~+/,text:c(i.text).replace("]|","~]|").replace("|$","|https?://|ftp://|www\\.|[a-zA-Z0-9.!#$%&'*+/=?^_`{\\|}~-]+@|$").getRegex()}),i.gfm.url=c(i.gfm.url).replace("email",i.gfm._extended_email).getRegex(),i.breaks=v({},i.gfm,{br:c(i.br).replace("{2,}","*").getRegex(),text:c(i.gfm.text).replace("{2,}","*").getRegex()}),s.rules=i,s.output=function(e,t,o){return new s(t,o).output(e)},s.prototype.output=function(e){for(var t,o,i,n,r,l,h="";e;)if(r=this.rules.escape.exec(e))e=e.substring(r[0].length),h+=r[1];else if(r=this.rules.autolink.exec(e))e=e.substring(r[0].length),i="@"===r[2]?"mailto:"+(o=a(this.mangle(r[1]))):o=a(r[1]),h+=this.renderer.link(i,null,o);else if(this.inLink||!(r=this.rules.url.exec(e))){if(r=this.rules.tag.exec(e))!this.inLink&&/^<a /i.test(r[0])?this.inLink=!0:this.inLink&&/^<\/a>/i.test(r[0])&&(this.inLink=!1),!this.inRawBlock&&/^<(pre|code|kbd|script)(\s|>)/i.test(r[0])?this.inRawBlock=!0:this.inRawBlock&&/^<\/(pre|code|kbd|script)(\s|>)/i.test(r[0])&&(this.inRawBlock=!1),e=e.substring(r[0].length),h+=this.options.sanitize?this.options.sanitizer?this.options.sanitizer(r[0]):a(r[0]):r[0];else if(r=this.rules.link.exec(e))e=e.substring(r[0].length),this.inLink=!0,i=r[2],this.options.pedantic?(t=/^([^'"]*[^\s])\s+(['"])(.*)\2/.exec(i))?(i=t[1],n=t[3]):n="":n=r[3]?r[3].slice(1,-1):"",i=i.trim().replace(/^<([\s\S]*)>$/,"$1"),h+=this.outputLink(r,{href:s.escapes(i),title:s.escapes(n)}),this.inLink=!1;else if((r=this.rules.reflink.exec(e))||(r=this.rules.nolink.exec(e))){if(e=e.substring(r[0].length),t=(r[2]||r[1]).replace(/\s+/g," "),!(t=this.links[t.toLowerCase()])||!t.href){h+=r[0].charAt(0),e=r[0].substring(1)+e;continue}this.inLink=!0,h+=this.outputLink(r,t),this.inLink=!1}else if(r=this.rules.strong.exec(e))e=e.substring(r[0].length),h+=this.renderer.strong(this.output(r[4]||r[3]||r[2]||r[1]));else if(r=this.rules.em.exec(e))e=e.substring(r[0].length),h+=this.renderer.em(this.output(r[6]||r[5]||r[4]||r[3]||r[2]||r[1]));else if(r=this.rules.code.exec(e))e=e.substring(r[0].length),h+=this.renderer.codespan(a(r[2].trim(),!0));else if(r=this.rules.br.exec(e))e=e.substring(r[0].length),h+=this.renderer.br();else if(r=this.rules.del.exec(e))e=e.substring(r[0].length),h+=this.renderer.del(this.output(r[1]));else if(r=this.rules.text.exec(e))e=e.substring(r[0].length),this.inRawBlock?h+=this.renderer.text(r[0]):h+=this.renderer.text(a(this.smartypants(r[0])));else if(e)throw new Error("Infinite loop on byte: "+e.charCodeAt(0))}else{if("@"===r[2])i="mailto:"+(o=a(r[0]));else{for(;l=r[0],r[0]=this.rules._backpedal.exec(r[0])[0],l!==r[0];);o=a(r[0]),i="www."===r[1]?"http://"+o:o}e=e.substring(r[0].length),h+=this.renderer.link(i,null,o)}return h},s.escapes=function(e){return e?e.replace(s.rules._escapes,"$1"):e},s.prototype.outputLink=function(e,t){var o=t.href,i=t.title?a(t.title):null;return"!"!==e[0].charAt(0)?this.renderer.link(o,i,this.output(e[1])):this.renderer.image(o,i,a(e[1]))},s.prototype.smartypants=function(e){return this.options.smartypants?e.replace(/---/g,"—").replace(/--/g,"–").replace(/(^|[-\u2014/(\[{"\s])'/g,"$1‘").replace(/'/g,"’").replace(/(^|[-\u2014/(\[{\u2018\s])"/g,"$1“").replace(/"/g,"”").replace(/\.{3}/g,"…"):e},s.prototype.mangle=function(e){if(!this.options.mangle)return e;for(var t,o="",i=e.length,s=0;s<i;s++)t=e.charCodeAt(s),.5<Math.random()&&(t="x"+t.toString(16)),o+="&#"+t+";";return o},n.prototype.code=function(e,t,o){if(this.options.highlight){var i=this.options.highlight(e,t);null!=i&&i!==e&&(o=!0,e=i)}return t?'<pre><code class="'+this.options.langPrefix+a(t,!0)+'">'+(o?e:a(e,!0))+"</code></pre>\n":"<pre><code>"+(o?e:a(e,!0))+"</code></pre>"},n.prototype.blockquote=function(e){return"<blockquote>\n"+e+"</blockquote>\n"},n.prototype.html=function(e){return e},n.prototype.heading=function(e,t,o){return this.options.headerIds?"<h"+t+' id="'+this.options.headerPrefix+o.toLowerCase().replace(/[^\w]+/g,"-")+'">'+e+"</h"+t+">\n":"<h"+t+">"+e+"</h"+t+">\n"},n.prototype.hr=function(){return this.options.xhtml?"<hr/>\n":"<hr>\n"},n.prototype.list=function(e,t,o){var i=t?"ol":"ul";return"<"+i+(t&&1!==o?' start="'+o+'"':"")+">\n"+e+"</"+i+">\n"},n.prototype.listitem=function(e){return"<li>"+e+"</li>\n"},n.prototype.checkbox=function(e){return"<input "+(e?'checked="" ':"")+'disabled="" type="checkbox"'+(this.options.xhtml?" /":"")+"> "},n.prototype.paragraph=function(e){return"<p>"+e+"</p>\n"},n.prototype.table=function(e,t){return t&&(t="<tbody>"+t+"</tbody>"),"<table>\n<thead>\n"+e+"</thead>\n"+t+"</table>\n"},n.prototype.tablerow=function(e){return"<tr>\n"+e+"</tr>\n"},n.prototype.tablecell=function(e,t){var o=t.header?"th":"td";return(t.align?"<"+o+' align="'+t.align+'">':"<"+o+">")+e+"</"+o+">\n"},n.prototype.strong=function(e){return"<strong>"+e+"</strong>"},n.prototype.em=function(e){return"<em>"+e+"</em>"},n.prototype.codespan=function(e){return"<code>"+e+"</code>"},n.prototype.br=function(){return this.options.xhtml?"<br/>":"<br>"},n.prototype.del=function(e){return"<del>"+e+"</del>"},n.prototype.link=function(e,t,o){if(this.options.sanitize){try{var i=decodeURIComponent(h(e)).replace(/[^\w:]/g,"").toLowerCase()}catch(e){return o}if(0===i.indexOf("javascript:")||0===i.indexOf("vbscript:")||0===i.indexOf("data:"))return o}this.options.baseUrl&&!p.test(e)&&(e=d(this.options.baseUrl,e));try{e=encodeURI(e).replace(/%25/g,"%")}catch(e){return o}var s='<a href="'+a(e)+'"';return t&&(s+=' title="'+t+'"'),s+">"+o+"</a>"},n.prototype.image=function(e,t,o){this.options.baseUrl&&!p.test(e)&&(e=d(this.options.baseUrl,e));var i='<img src="'+e+'" alt="'+o+'"';return t&&(i+=' title="'+t+'"'),i+(this.options.xhtml?"/>":">")},n.prototype.text=function(e){return e},r.prototype.strong=r.prototype.em=r.prototype.codespan=r.prototype.del=r.prototype.text=function(e){return e},r.prototype.link=r.prototype.image=function(e,t,o){return""+o},r.prototype.br=function(){return""},l.parse=function(e,t){return new l(t).parse(e)},l.prototype.parse=function(e){this.inline=new s(e.links,this.options),this.inlineText=new s(e.links,v({},this.options,{renderer:new r})),this.tokens=e.reverse();for(var t="";this.next();)t+=this.tok();return t},l.prototype.next=function(){return this.token=this.tokens.pop()},l.prototype.peek=function(){return this.tokens[this.tokens.length-1]||0},l.prototype.parseText=function(){for(var e=this.token.text;"text"===this.peek().type;)e+="\n"+this.next().text;return this.inline.output(e)},l.prototype.tok=function(){switch(this.token.type){case"space":return"";case"hr":return this.renderer.hr();case"heading":return this.renderer.heading(this.inline.output(this.token.text),this.token.depth,h(this.inlineText.output(this.token.text)));case"code":return this.renderer.code(this.token.text,this.token.lang,this.token.escaped);case"table":var e,t,o,i,s="",n="";for(o="",e=0;e<this.token.header.length;e++)o+=this.renderer.tablecell(this.inline.output(this.token.header[e]),{header:!0,align:this.token.align[e]});for(s+=this.renderer.tablerow(o),e=0;e<this.token.cells.length;e++){for(t=this.token.cells[e],o="",i=0;i<t.length;i++)o+=this.renderer.tablecell(this.inline.output(t[i]),{header:!1,align:this.token.align[i]});n+=this.renderer.tablerow(o)}return this.renderer.table(s,n);case"blockquote_start":for(n="";"blockquote_end"!==this.next().type;)n+=this.tok();return this.renderer.blockquote(n);case"list_start":n="";for(var r=this.token.ordered,l=this.token.start;"list_end"!==this.next().type;)n+=this.tok();return this.renderer.list(n,r,l);case"list_item_start":n="";var a=this.token.loose;for(this.token.task&&(n+=this.renderer.checkbox(this.token.checked));"list_item_end"!==this.next().type;)n+=a||"text"!==this.token.type?this.tok():this.parseText();return this.renderer.listitem(n);case"html":return this.renderer.html(this.token.text);case"paragraph":return this.renderer.paragraph(this.inline.output(this.token.text));case"text":return this.renderer.paragraph(this.parseText())}},a.escapeTest=/[&<>"']/,a.escapeReplace=/[&<>"']/g,a.replacements={"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#39;"},a.escapeTestNoEncode=/[<>"']|&(?!#?\w+;)/,a.escapeReplaceNoEncode=/[<>"']|&(?!#?\w+;)/g;var u={},p=/^$|^[a-z][a-z0-9+.-]*:|^[?#]/i;function g(){}function v(e){for(var t,o,i=1;i<arguments.length;i++)for(o in t=arguments[i])Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o]);return e}function f(e,t){var o=e.replace(/\|/g,function(e,t,o){for(var i=!1,s=t;0<=--s&&"\\"===o[s];)i=!i;return i?"|":" |"}).split(/ \|/),i=0;if(o.length>t)o.splice(t);else for(;o.length<t;)o.push("");for(;i<o.length;i++)o[i]=o[i].trim().replace(/\\\|/g,"|");return o}function b(e,t,o){if(0===e.length)return"";for(var i=0;i<e.length;){var s=e.charAt(e.length-i-1);if(s!==t||o){if(s===t||!o)break;i++}else i++}return e.substr(0,e.length-i)}function m(e,t,i){if(null==e)throw new Error("marked(): input parameter is undefined or null");if("string"!=typeof e)throw new Error("marked(): input parameter is of type "+Object.prototype.toString.call(e)+", string expected");if(i||"function"==typeof t){i||(i=t,t=null);var s,n,r=(t=v({},m.defaults,t||{})).highlight,h=0;try{s=o.lex(e,t)}catch(e){return i(e)}n=s.length;var c=function(e){if(e)return t.highlight=r,i(e);var o;try{o=l.parse(s,t)}catch(o){e=o}return t.highlight=r,e?i(e):i(null,o)};if(!r||r.length<3)return c();if(delete t.highlight,!n)return c();for(;h<s.length;h++)!function(e){"code"!==e.type?--n||c():r(e.text,e.lang,function(t,o){return t?c(t):null==o||o===e.text?--n||c():(e.text=o,e.escaped=!0,void(--n||c()))})}(s[h])}else try{return t&&(t=v({},m.defaults,t)),l.parse(o.lex(e,t),t)}catch(e){if(e.message+="\nPlease report this to https://github.com/markedjs/marked.",(t||m.defaults).silent)return"<p>An error occurred:</p><pre>"+a(e.message+"",!0)+"</pre>";throw e}}g.exec=g,m.options=m.setOptions=function(e){return v(m.defaults,e),m},m.getDefaults=function(){return{baseUrl:null,breaks:!1,gfm:!0,headerIds:!0,headerPrefix:"",highlight:null,langPrefix:"language-",mangle:!0,pedantic:!1,renderer:new n,sanitize:!1,sanitizer:null,silent:!1,smartLists:!1,smartypants:!1,tables:!0,xhtml:!1}},m.defaults=m.getDefaults(),m.Parser=l,m.parser=l.parse,m.Renderer=n,m.TextRenderer=r,m.Lexer=o,m.lexer=o.lex,m.InlineLexer=s,m.inlineLexer=s.output,m.parse=m,"undefined"!=typeof module&&"object"==typeof exports?module.exports=m:"function"==typeof define&&define.amd?define(function(){return m}):e.marked=m}("undefined"!=typeof window?window:global),window.marked&&window.marked.setOptions({sanitize:!1});class IoMdView extends IoElement{static get style(){return html`<style>:host {display: block;background-color: var(--io-background-color);color: var(--io-color);}:host > :first-child {margin-top: 0;}:host > :last-child {margin-top: 0;}:host p {line-height: 1.4em;}:host a {font-weight: bold;text-decoration: none;color: var(--io-color-link);}:host h1, :host h2, :host h3, :host h4 {margin: 0;border: var(--io-border);border-width: 0 0 var(--io-border-width) 0;}:host h1 {padding: 0.5em 0;}:host h2 {padding: 0.4em 0;}:host h3 {padding: 0.3em 0;}:host h4 {padding: 0.2em 0;}:host code {background-color: var(--io-background-color-dark);overflow: auto;font-weight: bold;}:host code.language-html,:host code.language-javascript {padding: 1em;display: block;}:host blockquote {font-size: 0.85em;opacity: 0.5;margin: 0;padding: var(--io-spacing) 0;}:host table{width: 100% !important;border: 1px solid black;border-collapse: collapse;table-layout: fixed;}:host table td,:host table tr,:host table th {border: 1px solid gray;padding: 0.25em;text-overflow: ellipsis;overflow: hidden;}:host .videocontainer {width: 100%;height: 0;position: relative;padding-bottom: 56.25%;}:host .videocontainer > iframe {position: absolute;top: 0;left: 0;width: 100%;height: 100%;}</style>`}static get attributes(){return{role:"document"}}static get properties(){return{path:{type:String,reflect:1},vars:Object}}pathChanged(){const e=this;fetch(this.path).then(e=>e.text()).then(t=>{window.marked&&(e.innerHTML=window.marked(t)),this.dispatchEvent("content-ready",{},!0)})}}IoMdView.Register();class IoMenuLayer extends IoElement{static get style(){return html`<style>:host {display: block;visibility: hidden;position: fixed;top: 0;left: 0;bottom: 0;right: 0;z-index: 100000;/* background: rgba(0, 0, 0, 0.05); */user-select: none;overflow: hidden;pointer-events: none;touch-action: none;}:host[expanded] {visibility: visible;pointer-events: all;}:host > io-menu-options {position: absolute;transform: translate3d(0, 0, 0);top: 0;left: 0;max-width: 90vw !important;}:host io-menu-item:hover {background-color: inherit;}:host io-menu-item:focus {background-color: var(--io-background-color-light);}</style>`}static get attributes(){return{expanded:{value:!1,notify:!0}}}static get properties(){return{lastFocus:HTMLElement,$options:Array}}static get listeners(){return{mousedown:"_onMousedown",mousemove:"_onMousemove",mouseup:"_onMouseup",touchstart:"_onTouchstart",touchmove:"_onTouchmove",touchend:"_onTouchend",contextmenu:"_onContextmenu"}}constructor(e){super(e),this._hoveredItem=null,this._hoveredOptions=null,this._startAnimation=this._startAnimation.bind(this),this._stopAnimation=this._stopAnimation.bind(this),this._x=0,this._y=0,this._v=0}connectedCallback(){super.connectedCallback(),window.addEventListener("scroll",this._onWindowScroll),window.addEventListener("wheel",this._onWindowScroll)}disconnectedCallback(){super.disconnectedCallback(),window.removeEventListener("scroll",this._onWindowScroll),window.removeEventListener("wheel",this._onWindowScroll),this._stopAnimation()}registerOptions(e){this.$options.push(e),clearTimeout(this.__timeout),this.__timeout=setTimeout(()=>{this.$options.sort((e,t)=>e._depth<t._depth?-1:1)})}unregisterOptions(e){this.$options.splice(this.$options.indexOf(e),1)}collapseAll(){for(let e=this.$options.length;e--;)this.$options[e].parentElement===this&&(this.$options[e].expanded=!1);this.expanded=!1}collapseSiblings(e){const t=this._getOptionschain(e);for(let e=this.$options.length;e--;)-1===t.indexOf(this.$options[e])&&this.$options[e].parentElement===this&&(this.$options[e].expanded=!1)}setLastFocus(e){const t=!(e.$parent&&e.$parent.parentElement===this),o=document.activeElement===document.body?null:document.activeElement,i=!(o&&o.$parent&&o.$parent.parentElement===this);this.lastFocus=t?e:i?o:this.lastFocus}_onOptionsExpanded(){this.expanded=!!this.$options.find(e=>e.parentElement===this&&e.expanded)}_onWindowScroll(){this.expanded&&this.collapseAll()}_onMousedown(e){e.preventDefault(),this._onPointermove(e),this._onPointerdown(e)}_onMousemove(e){e.preventDefault(),this._onPointermove(e)}_onMouseup(e){e.preventDefault(),this._onPointerup(e)}_onTouchstart(e){e.preventDefault(),this._onPointermove(e.changedTouches[0]),this._onPointerdown(e.changedTouches[0])}_onTouchmove(e){e.preventDefault(),this._onPointermove(e.changedTouches[0])}_onTouchend(e){e.preventDefault(),this._onPointerup(e)}_onContextmenu(e){e.preventDefault(),this.collapseAll()}_onPointerdown(){this._hoveredItem?this.lastFocus===this._hoveredItem&&this.lastFocus.expanded&&this.collapseAll():this.collapseAll()}_onPointermove(e){const t=e.clientX-this._x,o=e.clientY-this._y;this._v=(2*this._v+Math.abs(o)-Math.abs(t))/3,this._x=e.clientX,this._y=e.clientY,this._hoveredOptions=null,this._hoveredItem=null;let i=this.$options;for(let e=i.length;e--;)if(i[e].expanded){this._hoveredOptions=i[e];let t=i[e].getBoundingClientRect();if(t.top<this._y&&t.bottom>this._y&&t.left<this._x&&t.right>this._x){let t=i[e].querySelectorAll("io-menu-item");for(let o=t.length;o--;){let s=t[o].getBoundingClientRect();if(s.top<this._y&&s.bottom>this._y&&s.left<this._x&&s.right>this._x){let s=i[e].horizontal;return this._focusItem(t[o],s),void(this._hoveredItem=t[o])}}return i[e]}}if(this.lastFocus){let e=this.lastFocus.getBoundingClientRect();e.top<this._y&&e.bottom>this._y&&e.left<this._x&&e.right>this._x&&(this._hoveredItem=this.lastFocus)}}_focusItem(e,t){if(e!==this.__prevItem){const o=100;clearTimeout(this.__timeoutOpen),clearTimeout(this.__timeoutReset),this._v>1||e.parentNode!==this.__prevParent||t?(this.__prevItem=e,this._hoveredItem=e,e._toggleExpanded(!0),e.focus(),this.collapseSiblings(e)):this.__timeoutOpen=setTimeout(function(){this.__prevItem=e,this._hoveredItem=e,e._toggleExpanded(!0),e.focus(),this.collapseSiblings(e)}.bind(this),o),this.__prevParent=e.parentNode,this.__timeoutReset=setTimeout(function(){this.__prevItem=null,this.__prevParent=null}.bind(this),o+1)}}_onPointerup(e){if(this._hoveredItem){!this._hoveredItem._options&&(this._hoveredItem._onClick&&(e.preventDefault(),this._hoveredItem._onClick(e)),this.collapseAll())}else this.collapseAll()}_getOptionschain(e){const t=[];e.$options&&t.push(e.$options);let o=e.$parent;for(;o;)"io-menu-options"==o.localName&&t.push(o),o=o.$parent;return t}_moveHovered(){let e=this._hoveredOptions;if(e){let t=e.getBoundingClientRect();if(t.height>window.innerHeight){if(this._y<100&&t.top<0){let o=(100-this._y)/5e3,i=t.top;e._y=e._y-Math.ceil(i*o)+1}else if(this._y>window.innerHeight-100&&t.bottom>window.innerHeight){let o=(100-(window.innerHeight-this._y))/5e3,i=t.bottom-window.innerHeight;e._y=e._y-Math.ceil(i*o)-1}e.style.left=e._x+"px",e.style.top=e._y+"px"}}}_startAnimation(){this._moveHovered(),this._rAF_ID=requestAnimationFrame(this._startAnimation)}_stopAnimation(){this._rAF_ID&&cancelAnimationFrame(this._rAF_ID)}expandedChanged(){this.expanded?this._startAnimation():(this._hoveredItem=null,this._hoveredOptions=null,this._stopAnimation(),setTimeout(()=>{this.lastFocus&&(this.lastFocus.focus(),this.lastFocus=null)}))}}IoMenuLayer.Register(),IoMenuLayer.singleton=new IoMenuLayer,document.body.appendChild(IoMenuLayer.singleton);class IoMenuOptions extends IoElement{static get style(){return html`<style>:host {display: flex;flex-direction: column;white-space: nowrap;user-select: none;touch-action: none;background: var(--io-background-color-dark);color: var(--io-color);border-radius: var(--io-border-radius);border: var(--io-outset-border);border-color: var(--io-outset-border-color);box-shadow: var(--io-shadow);}:host:not([expanded]) {visibility: hidden;}:host[horizontal] {flex-direction: row;align-self: stretch;flex-wrap: nowrap;}:host[horizontal] > * {padding: calc(2 * var(--io-spacing)) calc(4 * var(--io-spacing));}:host:not([horizontal]) > io-menu-item > * {min-width: 0.5em;padding: 0 var(--io-spacing);}:host[horizontal] > io-menu-item > .io-menu-hint,:host[horizontal] > io-menu-item > .io-menu-more {display: none;}:host[horizontal] > io-menu-item.io-hamburger {line-height: 1.1em;margin-left: auto;}</style>`}static get attributes(){return{role:"listbox",expanded:{value:!0,notify:!0},overflow:{type:Boolean,notify:!0},horizontal:{type:Boolean,notify:!0}}}static get properties(){return{options:Array,position:"right",value:{value:null,notify:!0},$parent:HTMLElement,_depth:0,_rects:Array}}static get listeners(){return{"io-menu-item-clicked":"_onMenuItemClicked"}}connectedCallback(){super.connectedCallback(),IoMenuLayer.singleton.registerOptions(this)}disconnectedCallback(){super.disconnectedCallback(),IoMenuLayer.singleton.unregisterOptions(this)}_onMenuItemClicked(e){const t=e.composedPath()[0];t!==this&&(e.stopImmediatePropagation(),this.set("value",e.detail.value),this.dispatchEvent("io-menu-item-clicked",e.detail,!0),t.expanded=!1)}resized(){this.setOverflow()}setOverflow(){const e=this.querySelectorAll("io-menu-item:not(.io-hamburger)");if(this.horizontal){const t=this.querySelector("io-menu-item.io-hamburger"),o=this._rects;if(o.length=e.length,!o.length)return;if(!e.length)return;let i=this.getBoundingClientRect().right,s=!1,n=1/0;t.hidden=!0;const r=[];for(let l=e.length;l--;){const a=e[l].getBoundingClientRect();o[l]=o[l]||{right:0,width:0},0!==a.right&&(o[l].right=Math.min(o[l].right||1/0,a.right)),0!==a.width&&(o[l].width=Math.min(o[l].width||1/0,a.width)),t.hidden&&s&&(t.hidden=!1,i-=t.getBoundingClientRect().width),e[l].selected?(i-=o[l].width,e[l].hidden=!1):(n=Math.min(n,o[l].right))<i?e[l].hidden=!1:(e[l].hidden=!0,r.push(e[l].option),s=!0)}t.option={options:r},this.overflow=s}else for(let t=e.length;t--;)e[t].hidden=!1}nudgeRight(e,t,o){return e+o.width<window.innerWidth&&(this._x=e,this._y=Math.min(t,window.innerHeight-o.height),!0)}nudgeLeft(e,t,o){return e-o.width>0&&(this._x=e-o.width,this._y=Math.min(t,window.innerHeight-o.height),!0)}nudgeBottom(e,t,o){return t+o.height<window.innerHeight&&(this._y=t,this._x=Math.min(e,window.innerWidth-o.width),!0)}nudgeTop(e,t,o){return t-o.height>0&&(this._y=t-o.height,this._x=Math.min(e,window.innerWidth-o.width),!0)}expandedChanged(){if(this.parentElement===IoMenuLayer.singleton&&(IoMenuLayer.singleton._onOptionsExpanded(this),this.expanded&&this.$parent)){let e=this.getBoundingClientRect(),t=this.$parent.getBoundingClientRect();switch(this.position){case"pointer":this._x=this._x-1||t.x,this._y=this._y-1||t.y;break;case"top":this.nudgeTop(t.x,t.top,e)||this.nudgeBottom(t.x,t.bottom,e)||this.nudgeRight(t.right,t.top,e)||this.nudgeLeft(t.x,t.top,e);break;case"left":this.nudgeLeft(t.x,t.top,e)||this.nudgeRight(t.right,t.top,e)||this.nudgeBottom(t.x,t.bottom,e)||this.nudgeTop(t.x,t.top,e);break;case"bottom":this.nudgeBottom(t.x,t.bottom,e)||this.nudgeTop(t.x,t.top,e)||this.nudgeRight(t.right,t.top,e)||this.nudgeLeft(t.x,t.top,e);break;case"right":default:this.nudgeRight(t.right,t.top,e)||this.nudgeLeft(t.x,t.top,e)||this.nudgeBottom(t.right,t.bottom,e)||this.nudgeTop(t.right,t.top,e)}this.style.left=this._x+"px",this.style.top=this._y+"px"}}changed(){const e=this.horizontal?"bottom":"right",t=[this.options.map(t=>["io-menu-item",{$parent:this,option:t,value:this.value,direction:e,_depth:this._depth+1}])];this.horizontal&&t.push(["io-menu-item",{label:"☰",title:"select tab",value:this.value,class:"io-hamburger",_depth:this._depth}]),this.template(t),this.setOverflow()}}IoMenuOptions.Register();class IoMenuItem extends IoItem{static get style(){return html`<style>:host {display: flex;flex: 0 0 auto;flex-direction: row;padding: calc(2 * var(--io-spacing));background: none;}:host > * {pointer-events: none;}:host > :not(:empty) {padding: 0 var(--io-spacing);}:host > .io-menu-icon {}:host > .io-menu-label {flex: 1 1 auto;overflow: hidden;text-overflow: ellipsis;}:host > .io-menu-hint {opacity: 0.25;}:host[hasmore]:after {content: '▸';}:host {border: var(--io-border-width) solid transparent;}:host[selected][direction="top"],:host[selected][direction="bottom"] {border-bottom-color: var(--io-color-link);}:host[selected][direction="right"],:host[selected][direction="left"] {border-left-color: var(--io-color-link);}</style>`}static get attributes(){return{expanded:{value:!1,notify:!0},direction:{value:"bottom",notify:!0}}}static get properties(){return{expanded:Boolean,option:Object,$parent:HTMLElement,$options:HTMLElement,_depth:0}}_onMenuItemClicked(e){e.composedPath()[0]!==this&&(e.stopImmediatePropagation(),this.set("value",e.detail.value),this.dispatchEvent("io-menu-item-clicked",e.detail,!0),this.expanded=!1)}get _options(){if(this.option&&this.option.options&&this.option.options.length)return this.option.options}get _action(){if(this.option&&"function"==typeof this.option.action)return this.option.action}get _value(){return this.option&&void 0!==this.option.value?this.option.value:this.option&&"object"!=typeof this.option?this.option:void 0}get _icon(){if(this.option&&void 0!==this.option.icon)return this.option.icon}get _label(){return this.label?this.label:this.option&&void 0!==this.option.label?this.option.label:this.option&&void 0!==this.option.value?String(this.option.value):String(this.option)}get _hint(){if(this.option&&void 0!==this.option.hint)return this.option.hint}get _selected(){if(this.option&&(this.option.selected||this.option.value===this.value))return!0;if(this.value===this.option)return!0;const e=this._options;return!!e&&!!filterObject(e,e=>e===this.value||e.value===this.value)}connectedCallback(){super.connectedCallback(),this._updateOptions()}disconnectedCallback(){super.disconnectedCallback(),this._disconnectOptions(),this.removeEventListener("touchmove",this._onTouchmove),this.removeEventListener("touchend",this._onTouchend)}_updateOptions(){this._options?(this.$options?this.$options.setProperties({value:this.value,options:this._options||[],position:this.direction}):this.$options=new IoMenuOptions({$parent:this,expanded:this.bind("expanded"),value:this.value,options:this._options||[],position:this.direction,_depth:this._depth,"on-io-menu-item-clicked":this._onMenuItemClicked}),this.$options.parentNode||IoMenuLayer.singleton.appendChild(this.$options)):this._disconnectOptions()}_disconnectOptions(){this.$options&&this.$options.parentNode&&this.$options.parentNode.removeChild(this.$options)}_toggleExpanded(e){this._options?this.expanded=void 0!==e?e:!this.expanded:this.expanded=!1}_focusIn(){IoMenuLayer.singleton.setLastFocus(this),this.expanded&&setTimeout(()=>{this.$options.children.length&&this.$options.children[0].focus()})}_focusOut(){this.$parent&&this.$parent.$parent&&(this.$parent.expanded=!1,this.$parent.$parent.expanded=!1,this.$parent.$parent.focus())}_onMousedown(){IoMenuLayer.singleton.setLastFocus(this),this.focus(),this._toggleExpanded(!0),IoMenuLayer.singleton._onMousemove(event)}_onTouchstart(e){e.cancelable&&(e.preventDefault(),this.addEventListener("touchmove",this._onTouchmove),this.addEventListener("touchend",this._onTouchend),IoMenuLayer.singleton.setLastFocus(this),this.focus(),this._toggleExpanded(!0),IoMenuLayer.singleton._onTouchmove(e))}_onTouchmove(e){IoMenuLayer.singleton._onTouchmove(e)}_onTouchend(e){e.preventDefault(),this.removeEventListener("touchmove",this._onTouchmove),this.removeEventListener("touchend",this._onTouchend),IoMenuLayer.singleton._onTouchend(e)}_onKeydown(e){let t="";if("left"===this.direction||"right"===this.direction?("ArrowUp"===e.key&&(t="prev"),"ArrowRight"===e.key&&(t="in"),"ArrowDown"===e.key&&(t="next"),"ArrowLeft"===e.key&&(t="out")):("ArrowUp"===e.key&&(t="out"),"ArrowRight"===e.key&&(t="next"),"ArrowDown"===e.key&&(t="in"),"ArrowLeft"===e.key&&(t="prev")),"Tab"===e.key&&(t="next"),13===e.which||32===e.which)e.preventDefault(),this._options?(this._toggleExpanded(!0),this._focusIn()):this._onClick(e);else if("Escape"===e.key)e.preventDefault(),IoMenuLayer.singleton.collapseAll();else if(this.$parent&&this.$parent.parentElement===IoMenuLayer.singleton){const o=[...this.$parent.children],i=o.indexOf(this);switch(t&&e.preventDefault(),t){case"prev":this.expanded=!1,o[(i+o.length-1)%o.length].focus();break;case"next":this.expanded=!1,o[(i+1)%o.length].focus();break;case"in":this._focusIn();break;case"out":this.expanded=!1,this._focusOut()}}else this.expanded&&"in"===t?this._focusIn():(this.expanded=!1,super._onKeydown(e))}_onClick(e){this._action&&this._action.apply(null,[this._value]),void 0!==this._value&&(e.stopImmediatePropagation(),this.set("value",this._value,!0),this.dispatchEvent("io-menu-item-clicked",{value:this._value},!0),this.expanded=!1)}_onFocus(){super._onFocus(),this.$parent&&this.$parent.parentElement===IoMenuLayer.singleton&&this._toggleExpanded(!0)}expandedChanged(){this.expanded&&this.$parent&&!this.$parent.expanded&&console.warn("This should be expanded",this.$parent.expanded)}valueChanged(){this._updateOptions()}optionChanged(){this._updateOptions()}directionChanged(){this._updateOptions()}changed(){this.selected=this._selected,this.setAttribute("hasmore",this._options&&"right"===this.direction),this.template([["span",{class:"io-menu-icon"},this._icon],["span",{class:"io-menu-label"},this._label||String(this._value)],["span",{class:"io-menu-hint"},this._hint]])}}IoMenuItem.Register();class IoMenu extends IoElement{static get properties(){return{value:null,options:Array,expanded:Boolean,position:"pointer",button:0,$options:IoMenuOptions}}get compose(){return{$options:{$parent:this,expanded:this.bind("expanded"),options:this.options,position:this.position,"on-io-menu-item-clicked":this._onMenuItemClicked}}}connectedCallback(){super.connectedCallback(),this.parentElement.addEventListener("contextmenu",this._onContextmenu),this.parentElement.addEventListener("mousedown",this._onMousedown),this.parentElement.addEventListener("touchstart",this._onTouchstart),IoMenuLayer.singleton.appendChild(this.$options)}disconnectedCallback(){super.disconnectedCallback(),this.parentElement.removeEventListener("contextmenu",this._onContextmenu),this.parentElement.removeEventListener("mousedown",this._onMousedown),this.parentElement.removeEventListener("touchstart",this._onTouchstart),this.parentElement.removeEventListener("touchmove",this._onTouchmove),this.parentElement.removeEventListener("touchend",this._onTouchend),this.$options&&IoMenuLayer.singleton.removeChild(this.$options)}getBoundingClientRect(){return this.parentElement.getBoundingClientRect()}_onMenuItemClicked(e){e.composedPath()[0]!==this&&(e.stopImmediatePropagation(),this.set("value",e.detail.value),this.dispatchEvent("io-menu-item-clicked",e.detail,!0),this.expanded=!1)}_onContextmenu(e){this.options.length&&2===this.button&&(e.preventDefault(),IoMenuLayer.singleton.setLastFocus(document.activeElement),this.$options._x=e.clientX-5,this.$options._y=e.clientY-5,this.expanded=!0,this.$options.children[0].focus())}_onMousedown(e){this.options.length&&e.button===this.button&&2!==e.button&&(e.preventDefault(),IoMenuLayer.singleton.setLastFocus(document.activeElement),this.$options._x=e.clientX-5,this.$options._y=e.clientY-5,this.expanded=!0,this.$options.children[0].focus())}_onTouchstart(e){this.options.length&&e.cancelable&&2!==this.button&&(e.preventDefault(),this.parentElement.addEventListener("touchmove",this._onTouchmove),this.parentElement.addEventListener("touchend",this._onTouchend),IoMenuLayer.singleton.setLastFocus(document.activeElement),this.$options._x=e.changedTouches[0].clientX-5,this.$options._y=e.changedTouches[0].clientY-5,this.expanded=!0,this.$options.children[0].focus())}_onTouchmove(e){IoMenuLayer.singleton._onTouchmove(e)}_onTouchend(e){this.parentElement.removeEventListener("touchmove",this._onTouchmove),this.parentElement.removeEventListener("touchend",this._onTouchend),IoMenuLayer.singleton._onTouchend(e)}}IoMenu.Register();class IoNumber extends IoItem{static get style(){return html`<style>:host {white-space: nowrap;border: var(--io-inset-border);border-radius: var(--io-border-radius);border-color: var(--io-inset-border-color);color: var(--io-color-field);background-color: var(--io-background-color-field);user-select: text;}</style>`}static get attributes(){return{role:"textbox",type:"number",pattern:'pattern="[0-9]*"',inputmode:"numeric",contenteditable:!0}}static get properties(){return{value:Number,conversion:1,step:.001,min:-1/0,max:1/0,strict:!0}}constructor(e){super(e),this.setAttribute("spellcheck","false")}_onFocus(e){super._onFocus(e),this._innerTextOnFocus=this.innerText}_onBlur(e){super._onBlur(e),this._innerTextOnFocus!==this.innerText&&this.setFromText(this.innerText),this.scrollTop=0,this.scrollLeft=0}_onKeydown(e){const t=window.getSelection().getRangeAt(0),o=t.startOffset,i=t.endOffset,s=this.childNodes[0]?this.childNodes[0].length:0,n=t.startContainer===t.endContainer&&(t.startContainer===this.childNodes[0]||t.startContainer===this);13==e.which?(e.preventDefault(),this.setFromText(this.innerText)):37==e.which?n&&o===i&&0===o&&(e.preventDefault(),this.focusTo("left")):38==e.which?n&&o===i&&0===o&&(e.preventDefault(),this.focusTo("up")):39==e.which?n&&o===i&&o===s&&(e.preventDefault(),this.focusTo("right")):40==e.which&&n&&o===i&&o===s&&(e.preventDefault(),this.focusTo("down"))}setFromText(e){let t=Math.round(Number(e)/this.step)*this.step/this.conversion;this.strict&&(t=Math.min(this.max,Math.max(this.min,t))),isNaN(t)?this.innerText="NaN":this.set("value",t)}changed(){let e=this.value;if("number"!=typeof e||isNaN(e))this.innerText="NaN";else{e*=this.conversion;let t=-Math.round(Math.log(this.step)/Math.LN10);t=Math.max(0,Math.min(100,t)),e=e.toFixed(t),this.innerText=Number(String(e))}this.setAttribute("aria-invalid",!("number"==typeof this.value&&!isNaN(this.value))&&"true"),this.setAttribute("aria-valuemin",this.min!==-1/0&&this.min),this.setAttribute("aria-valuemax",this.max!==1/0&&this.max)}}IoNumber.Register();class IoProperties extends IoElement{static get style(){return html`<style>:host {display: flex;flex-direction: column;align-self: stretch;}:host > .io-property {display: flex !important;flex-direction: row;flex: 1 0 auto;align-items: flex-start;}:host > .io-property > * {background: none;border-color: transparent;}:host > .io-property > .io-property-label {margin: 0;border: var(--io-border);border-color: transparent;color: var(--io-color);flex: 0 0 auto;padding: var(--io-spacing);padding-right: 0;}:host > .io-property > .io-property-editor {flex: 1 1 auto;}:host io-number,:host io-string,:host io-boolean,:host io-switch,:host > .io-property > io-option {flex: 0 0 auto;padding: var(--io-spacing) !important;}:host > .io-property > io-number {color: var(--io-color-number);}:host > .io-property > io-string {color: var(--io-color-string);}:host > .io-property > io-boolean {color: var(--io-color-boolean);}:host > .io-property > io-switch:not([value]),:host > .io-property > io-boolean:not([value]) {opacity: 0.5;}</style>`}static get properties(){return{labeled:!0,value:Object,properties:Array,config:Object}}get _config(){return this.__proto__.__config.getConfig(this.value,this.config)}_onValueSet(e){const t=e.composedPath()[0];if(t===this)return;if(e.detail.object)return;e.stopImmediatePropagation();const o=t.id;if(null!==o&&"value"===e.detail.property){this.value[o]=e.detail.value;const t=Object.assign({object:this.value,property:o},e.detail);this.dispatchEvent("object-mutated",t,!1,window)}}changed(){const e=this._config,t=[];for(let o in e)if(!this.properties.length||-1!==this.properties.indexOf(o)){const i=e[o][0],s=e[o][1],n=e[o].label||o,r={class:"io-property-editor",title:n,id:o,value:this.value[o],"on-value-set":this._onValueSet};t.push(["div",{class:"io-property"},[this.labeled?["span",{class:"io-property-label",title:n},n+":"]:null,[i,Object.assign(r,s)]]])}this.template(t)}static get config(){return{"type:string":["io-string",{}],"type:number":["io-number",{step:1e-7}],"type:boolean":["io-boolean",{}],"type:object":["io-object",{}],"type:null":["io-string",{}],"type:undefined":["io-string",{}]}}}class Config$1{constructor(e){for(let t=0;t<e.length;t++)this.registerConfig(e[t].constructor.config||{})}registerConfig(e){for(let t in e)this[t]=this[t]||[],this[t]=[e[t][0]||this[t][0],Object.assign(this[t][1]||{},e[t][1]||{})]}getConfig(e,t){const o=Object.keys(e),i=[];let s=e.__proto__;for(;s;)s.constructor!==HTMLElement&&s.constructor!==Element&&s.constructor!==Node&&s.constructor!==EventTarget&&s.constructor!==Object&&o.push(...Object.keys(s)),i.push(s.constructor.name),s=s.__proto__;const n={};for(let e in this){const t=e.split("|");1===t.length&&t.splice(0,0,"Object"),-1!==i.indexOf(t[0])&&(n[t[1]]=this[e])}for(let e in t){const o=e.split("|");1===o.length&&o.splice(0,0,"Object"),-1!==i.indexOf(o[0])&&(n[o[1]]=t[e])}const r={};for(let t=0;t<o.length;t++){const i=o[t],s=e[i],l=null===s?"null":typeof s,a=null!=s&&s.constructor?s.constructor.name:"null";if("function"==l)continue;const h="type:"+l,c="constructor:"+a,d=i.replace("type:","").replace("constructor:","");r[i]={},n[h]&&(r[i]=n[h]),n[c]&&(r[i]=n[c]),n[d]&&(r[i]=n[d])}return r}}IoProperties.Register=function(){IoElement.Register.call(this),Object.defineProperty(this.prototype,"__config",{value:new Config$1(this.prototype.__protochain)})},IoProperties.Register(),IoProperties.RegisterConfig=function(e){this.prototype.__config.registerConfig(e)};class IoObject extends IoCollapsable{static get style(){return html`<style>:host {padding: 0;border: none;background: none;}:host > .io-content {display: block;overflow: auto;padding: 0;border: none;background: none;}</style>`}static get properties(){return{value:Object,properties:Array,config:Object,labeled:!0}}changed(){const e=this.label||this.value.constructor.name;this.template([["io-boolean",{true:e,false:e,value:this.expanded,"on-value-set":this._onButtonValueSet}],this.expanded?[["io-properties",{class:"io-content",value:this.value,properties:this.properties,config:this.config,labeled:this.labeled}]]:null]),this.setAttribute("aria-expanded",String(this.expanded))}}IoObject.Register();class IoOption extends IoMenuItem{static get style(){return html`<style>:host {white-space: pre;display: inline-block;background-color: var(--io-background-color-dark);background-image: var(--io-gradient-button);border: var(--io-outset-border);border-color: var(--io-outset-border-color);border-radius: var(--io-border-radius);padding: var(--io-spacing);padding-left: calc(3 * var(--io-spacing));padding-right: var(--io-spacing);transition: background-color 0.4s;}:host:not([label])::after {content: '▾';padding-left: var(--io-spacing);}</style>`}static get attributes(){return{role:"button"}}static get properties(){return{options:Array}}get _options(){if(this.options&&this.options.length)return this.options}_onMenuItemClicked(e){e.composedPath()[0]!==this&&(e.stopImmediatePropagation(),this.expanded=!1,this.set("value",e.detail.value,!0),this.dispatchEvent("io-menu-item-clicked",e.detail,!0))}_onClick(){this._toggleExpanded(!0)}_onKeydown(e){13===e.which||32===e.which?(e.preventDefault(),this._toggleExpanded(!0),this._focusIn()):"ArrowLeft"===e.key?(e.preventDefault(),IoMenuLayer.singleton.LastFocus=null,this.expanded=!1,this.focusTo("left")):"ArrowUp"===e.key?(e.preventDefault(),IoMenuLayer.singleton.LastFocus=null,this.expanded=!1,this.focusTo("up")):"ArrowRight"===e.key?(e.preventDefault(),IoMenuLayer.singleton.LastFocus=null,this.expanded=!1,this.focusTo("right")):"ArrowDown"===e.key&&(e.preventDefault(),IoMenuLayer.singleton.LastFocus=null,this.expanded?this._focusIn():this.focusTo("down"))}changed(){const e=this.options;let t=this.label;if(e&&!t){const e=this.options.find(e=>e.value===this.value);e&&(t=e.label?e.label:"object"==typeof e.value?`${e.value.constructor.name}`+(e.value instanceof Array?`(${e.value.length})`:""):String(e.value))}this.title=t||String(this.value),this.innerText=t||String(this.value),this.setAttribute("aria-haspopup","listbox"),this.setAttribute("aria-expanded",String(this.expanded))}}IoOption.Register();const importedPaths={};class IoSelector extends IoElement{static get style(){return html`<style>:host {display: flex;flex-direction: column;align-self: stretch;overflow: auto;}:host[_loading] > .io-content {background: repeating-linear-gradient(135deg, var(--io-background-color-light), var(--io-background-color) 3px, var(--io-background-color) 7px, var(--io-background-color-light) 10px);background-repeat: repeat;}:host > .io-content {background: var(--io-background-color);color: var(--io-color);display: flex;flex-direction: column;flex: 1 1 auto;overflow: auto;}</style>`}static get attributes(){return{}}static get properties(){return{elements:Array,selected:String,cache:Boolean,precache:Boolean,_loading:{type:Boolean,reflect:1},_caches:Object,_selectedID:String,_scrollID:{type:String,notify:!0}}}static get listeners(){return{scroll:"_onScroll","content-ready":"_onIoContentReady"}}_onIoContentReady(e){e.stopImmediatePropagation(),this.scrollIDChanged()}constructor(e){super(e),this.stagingElement=document.createElement("io-selector-staging")}connectedCallback(){super.connectedCallback(),document.head.appendChild(this.stagingElement),document.addEventListener("readystatechange",this.precacheChanged)}disconnectedCallback(){super.disconnectedCallback(),document.head.removeChild(this.stagingElement),document.removeEventListener("readystatechange",this.precacheChanged)}checkImport(e,t){const o=e?new URL(e,window.location).href:void 0;!e||importedPaths[o]?t():(this.__callback=t,o&&!importedPaths[o]&&import(o).then(()=>{importedPaths[o]=!0,this.__callback(),delete this.__callback}))}precacheChanged(){if(this.__connected&&this.precache&&"complete"===document.readyState)for(let e=0;e<this.elements.length;e++){const t=this.elements[e][1].name,o=!1===this.elements[e][1].cache||!!this.elements[e][1].import;this._caches[t]||o||this.checkImport(this.elements[e][1].import,()=>{this.stagingElement.parentElement!==document.head&&document.head.appendChild(this.stagingElement),this.template([this.elements[e]],this.stagingElement),this._caches[t]=this.stagingElement.childNodes[0],this.stagingElement.innerText=""})}}renderShadow(){this.template([["div",{id:"content",class:"io-content"}]])}scrollTo(e){if(e){const t=this.$.content.querySelector("#"+e);t&&t.scrollIntoView({behavior:"smooth"})}}_onScroll(){void 0!==this._scrollID&&(clearTimeout(this.__scrollDebounce),this.__scrollDebounce=setTimeout(()=>{delete this.__scrollDebounce;const e=[...this.$.content.querySelectorAll("[id]")],t=this.$.content.scrollTop,o=t+this.$.content.getBoundingClientRect().height/2,i=this._scrollID;let s;for(let i=e.length;i--;){const n=e[i],r=e[i+1],l=n.offsetTop,a=r?r.offsetTop:l;if(l<t-5&&a<o)break;s=n.id}if(s!==i){this._scrollID=s;const e=this.selected,t=this._selectedID+"#"+this._scrollID;this.__properties.selected.value=t,this.dispatchEvent("selected-changed",{value:t,oldValue:e})}},100))}scrollIDChanged(){void 0!==this._scrollID&&setTimeout(()=>{this.scrollTo(this._scrollID)},100)}selectedChanged(){const e=this._scrollID,t=this._selectedID,o=this.selected.split("#")[0],i=this.selected.split("#")[1];o!==t?(this._selectedID=o,this._scrollID=i,this.scrollIDChanged(),this.update()):i!==e&&(this._scrollID=i,this.scrollIDChanged())}elementsChanged(){this.selectedChanged()}update(){const e=this._selectedID;let t=this.elements.find(t=>t[1].name===e);t||(t=["div",{}]),"object"!=typeof t[1]&&t.splice(1,0,{});const o=!0===t[1].cache,i=!1===t[1].cache;this.renderShadow(),this.$.content&&(this.$.content.innerText=""),!i&&(this.precache||this.cache||o)&&this._caches[e]?this.$.content.appendChild(this._caches[e]):(this._loading=!0,this.checkImport(t[1].import,()=>{this._loading=!1,this.template([t],this.$.content),this._caches[e]=this.$.content.childNodes[0]}))}}IoSelector.Register();class IoSidebar extends IoElement{static get style(){return html`<style>:host {display: flex;flex-wrap: nowrap;overflow: auto;flex: 0 0 auto;line-height: 1.5em;padding: 0 var(--io-spacing);}:host[overflow] {font-size: 1.2em;}:host:not([overflow]) {-webkit-overflow-scrolling: touch;flex-direction: column;}:host io-collapsable,:host io-boolean,:host .io-content,:host io-button {flex: 0 0 auto;margin: 0;padding: var(--io-spacing) calc(2 * var(--io-spacing));border: none;background: none;}:host > io-collapsable io-boolean {opacity: 0.75;}:host .io-content {display: flex;flex-direction: column;padding-left: 1em;}:host io-button.io-selected-tab {color: var(--io-color-link);text-decoration: underline;}:host > span {color: var(--io-color);display: inline-block;cursor: default;white-space: nowrap;-webkit-tap-highlight-color: transparent;overflow: hidden;text-overflow: ellipsis;padding: var(--io-spacing);padding-left: calc(3 * var(--io-spacing));padding-right: calc(3 * var(--io-spacing));}:host > io-option {background: none !important;border: none;padding-left: calc(3 * var(--io-spacing));padding-right: calc(3 * var(--io-spacing));}</style>`}static get attributes(){return{role:"navigation",label:{type:String,notify:!0},overflow:{type:Boolean,notify:!0}}}static get properties(){return{selected:String,options:Array}}_onSelect(e){this.set("selected",e)}_onValueSet(e){this.set("selected",e.detail.value)}_addOptions(e){const t=[];for(let o=0;o<e.length;o++){const i=e[o];if(i.options){const s=i.label+" "+o+"/"+e.length+" ("+i.options.length+")";t.push(["io-collapsable",{label:i.label,expanded:IoStorage("io-sidebar-collapse "+s,!0),elements:[...this._addOptions(i.options)]}])}else{const e=this.selected&&(this.selected===i||this.selected===i.value);t.push(["io-button",{label:i.label||i.value||i,value:i.value||i,action:this._onSelect,class:(e?"io-selected-tab":"")+" io-tab"}])}}return t}changed(){let e=filterObject(this.options.map(e=>new Option(e)),e=>e.value===this.selected);if(this.overflow){const t=e?e.label||String(e.value):String(this.selected).split("#")[0];this.template([["io-option",{label:"☰  "+t,title:"select tab",value:this.selected,options:this.options,"on-value-set":this._onValueSet}]])}else this.template([...this._addOptions(this.options)])}}IoSidebar.Register();class IoSelectorSidebar extends IoSelector{static get style(){return html`<style>:host {flex-direction: row;align-self: stretch;flex: 1 1 auto;}:host[overflow] {flex-direction: column;}:host > io-sidebar {background-color: var(--io-background-color-dark);}:host:not([overflow]) > io-sidebar {flex: 0 0 8em;}:host > .io-content {overflow: auto;-webkit-overflow-scrolling: touch;border: var(--io-border);border-width: 0 0 0 var(--io-border-width);}:host[overflow] > .io-content {border-width: var(--io-border-width) 0 0 0;}</style>`}static get attributes(){return{role:"navigation",label:{type:String,notify:!0},overflow:{type:Boolean,notify:!0}}}static get properties(){return{options:Array,left:!0,minWidth:410}}_onScroll(){if(super._onScroll(),this.$.sidebar.selected!==this.selected){!!filterObject(this.options,e=>e===this.selected||e.value===this.selected)&&(this.$.sidebar.selected=this.selected)}}minWidthChanged(){this.resized()}resized(){this.overflow=this.getBoundingClientRect().width<this.minWidth}leftChanged(){this.renderShadow()}overflowChanged(){this.renderShadow()}renderShadow(){const e=["io-sidebar",{id:"sidebar",elements:this.elements,selected:this.bind("selected"),options:this.options.length?this.options:this.elements.map(e=>e[1].name),overflow:this.overflow}];this.left?this.template([e,["div",{id:"content",class:"io-content","on-scroll":this._onScroll}]]):this.template([["div",{id:"content",class:"io-content","on-scroll":this._onScroll}],e])}}IoSelectorSidebar.Register();class IoSelectorTabs extends IoSelector{static get style(){return html`<style>:host {flex-direction: column;align-self: stretch;flex: 1 1 auto;}:host > io-menu-options {border-radius: 0;border: none;font-size: 1.2em;background-color: var(--io-background-color-dark);}:host > .io-content {overflow: auto;-webkit-overflow-scrolling: touch;border: var(--io-border);border-width: var(--io-border-width) 0 0 0;}</style>`}static get attributes(){return{}}static get properties(){return{options:Array}}_onScroll(){if(super._onScroll(),this.$.tabs.selected!==this.selected){!!filterObject(this.options,e=>e===this.selected||e.value===this.selected)&&(this.$.tabs.selected=this.selected)}}renderShadow(){const e=["io-menu-options",{id:"tabs",role:"navigation",horizontal:!0,value:this.bind("selected"),options:this.options.length?this.options:this.elements.map(e=>e[1].name)}];this.template([e,["div",{id:"content",class:"io-content","on-scroll":this._onScroll}]])}}IoSelectorTabs.Register();class IoSlider extends IoElement{static get style(){return html`<style>:host {display: flex;align-self: stretch;}:host > io-number {flex: 0 0 3.75em;margin-right: var(--io-spacing);}:host > io-slider-knob {flex: 1 1 auto;}</style>`}static get properties(){return{value:0,step:.001,min:0,max:1}}_onValueSet(e){this.value=e.detail.value,this.dispatchEvent("value-set",e.detail,!1)}changed(){this.template([["io-number",{id:"number",value:this.value,step:this.step,min:this.min,max:this.max,label:this.label,title:this.title,"on-value-set":this._onValueSet}],["io-slider-knob",{id:"slider",value:this.value,step:this.step,minValue:this.min,maxValue:this.max,label:this.label,title:this.title,"on-value-set":this._onValueSet}]])}}IoSlider.Register();class IoSliderKnob extends IoQuad{static get style(){return html`<style>:host {cursor: ew-resize;border: var(--io-inset-border);border-radius: var(--io-border-radius);border-color: var(--io-inset-border-color);min-height: 1.2em;align-self: stretch;}:host[aria-invalid] {border-color: var(--io-color-error);}:host:focus {outline: 1px solid var(--io-color-focus);outline-offset: -1px;}</style>`}static get attributes(){return{role:"slider",tabindex:0}}static get properties(){return{value:0,step:.01,minValue:0,maxValue:1e3,startColor:[.3,.9,1,1],endColor:[.9,1,.5,1],lineColor:[.5,.5,.5,1],bg:[.2,.2,.2,1],snapWidth:2,slotWidth:2,handleWidth:4}}static get listeners(){return{touchstart:"_onTouchstart",mousedown:"_onMousedown",keydown:"_onKeydown"}}_onTouchstart(e){this.addEventListener("touchmove",this._onTouchmove),this.addEventListener("touchend",this._onTouchend),this._onPointerdown(e)}_onTouchmove(e){this._onPointermove(e)}_onTouchend(){this.removeEventListener("touchmove",this._onTouchmove),this.removeEventListener("touchend",this._onTouchend)}_onMousedown(e){e.preventDefault(),this.focus(),window.addEventListener("mousemove",this._onMousemove),window.addEventListener("mouseup",this._onMouseup),this._onPointerdown(e)}_onMousemove(e){this._onPointermove(e)}_onMouseup(){window.removeEventListener("mousemove",this._onMousemove),window.removeEventListener("mouseup",this._onMouseup)}disconnectedCallback(){super.disconnectedCallback(),window.removeEventListener("mousemove",this._onMousemove),window.removeEventListener("mouseup",this._onMouseup)}_onPointerdown(e){const t=e.changedTouches?e.changedTouches[0]:e;this._x=t.clientX,this._y=t.clientY,this._active=-1}_onPointermove(e){const t=e.changedTouches?e.changedTouches[0]:e,o=Math.abs(this._x-t.clientX),i=Math.abs(this._y-t.clientY);if(-1===this._active&&o>5&&(this._active=o>i&&i<20?1:0),1!==this._active)return;if(!e.cancelable)return;e.preventDefault(),this.focus();const s=this.getBoundingClientRect(),n=(t.clientX-s.x)/s.width,r=Math.max(0,Math.min(1,n));let l=(this.maxValue-this.minValue)*r;l=this.minValue+Math.round(l/this.step)*this.step,l=Math.min(this.maxValue,Math.max(this.minValue,l));let a=-Math.round(Math.log(this.step)/Math.LN10);a=Math.max(0,Math.min(100,a)),l=Number(l.toFixed(a)),this.set("value",l)}_onKeydown(e){37==e.which?(e.preventDefault(),e.shiftKey?this._moveSliderByKey("decrease"):this.focusTo("left")):38==e.which?(e.preventDefault(),e.shiftKey?this._moveSliderByKey("decrease"):this.focusTo("up")):39==e.which?(e.preventDefault(),e.shiftKey?this._moveSliderByKey("increase"):this.focusTo("right")):40==e.which?(e.preventDefault(),e.shiftKey?this._moveSliderByKey("increase"):this.focusTo("down")):33==e.which?(e.preventDefault(),this._moveSliderByKey("increase")):34==e.which?(e.preventDefault(),this._moveSliderByKey("decrease")):36==e.which?(e.preventDefault(),this._moveSliderByKey("min")):35==e.which&&(e.preventDefault(),this._moveSliderByKey("max"))}_moveSliderByKey(e){let t=this.value;switch(e){case"increase":t+=this.step;break;case"decrease":t-=this.step;break;case"min":t=this.minValue;break;case"max":t=this.maxValue}t=Math.min(this.maxValue,Math.max(this.minValue,t));let o=-Math.round(Math.log(this.step)/Math.LN10);o=Math.max(0,Math.min(100,o)),t=Number(t.toFixed(o)),this.set("value",t)}changed(){super.changed(),this.setAttribute("aria-invalid",!("number"==typeof this.value&&!isNaN(this.value))&&"true"),this.setAttribute("aria-valuenow",this.value),this.setAttribute("aria-valuemin",this.minValue),this.setAttribute("aria-valuemax",this.maxValue),this.setAttribute("aria-valuestep",this.step)}static get frag(){return"\n    #extension GL_OES_standard_derivatives : enable\n\n    varying vec2 vUv;\n\n    void main(void) {\n\n      vec4 finalColor = bg;\n\n      float _range = maxValue - minValue;\n      float _progress = (value - minValue) / _range;\n      float _value = mix(minValue, maxValue, vUv.x);\n      float _stepRange = size.x / (_range / step);\n\n      if (_stepRange > snapWidth * 2.0) {\n        float res = _value / step;\n        float line = abs(fract(res - 0.5) - 0.5) / abs(dFdx(res)) / snapWidth;\n        finalColor = mix(finalColor, lineColor, 1.0 - min(line, 1.0));\n      }\n\n      float slot = (abs(0.5 - vUv.y) * 2.0) * size.y;\n      slot = (1.0 - slot) + slotWidth;\n      slot = clamp(slot, 0.0, 1.0);\n      vec4 slotColor = mix(startColor, endColor, vUv.x);\n      float progress = (vUv.x - _progress) * size.x;\n      progress = clamp(progress, 0.0, 1.0);\n      slotColor = mix(slotColor, lineColor, progress);\n\n      float handle = abs(vUv.x - _progress) * size.x;\n      handle = (1.0 - handle) + handleWidth;\n      handle = clamp(handle, 0.0, 1.0);\n\n      finalColor = mix(finalColor, slotColor, slot);\n      finalColor = mix(finalColor, mix(startColor, endColor, _progress), handle);\n      gl_FragColor = finalColor;\n    }"}}IoSliderKnob.Register();class IoString extends IoItem{static get style(){return html`<style>:host {border: var(--io-inset-border);border-radius: var(--io-border-radius);border-color: var(--io-inset-border-color);color: var(--io-color-field);background-color: var(--io-background-color-field);user-select: text;}:host:empty:after {display: inline-block;content: '"';}</style>`}static get attributes(){return{role:"textbox",contenteditable:!0}}static get properties(){return{value:String}}_onBlur(e){super._onBlur(e),this.removeEventListener("blur",this._onBlur),this.removeEventListener("keydown",this._onKeydown),"string"!=typeof this.value&&this.innerText===String(this.value)||this.set("value",this.innerText),this.scrollTop=0,this.scrollLeft=0}_onKeydown(e){const t=window.getSelection().getRangeAt(0),o=t.startOffset,i=t.endOffset,s=this.childNodes[0]?this.childNodes[0].length:0,n=t.startContainer===t.endContainer&&(t.startContainer===this.childNodes[0]||t.startContainer===this);13==e.which?(e.preventDefault(),"string"!=typeof this.value&&this.innerText===String(this.value)||this.set("value",this.innerText)):37==e.which?n&&o===i&&0===o&&(e.preventDefault(),this.focusTo("left")):38==e.which?n&&o===i&&0===o&&(e.preventDefault(),this.focusTo("up")):39==e.which?n&&o===i&&o===s&&(e.preventDefault(),this.focusTo("right")):40==e.which&&n&&o===i&&o===s&&(e.preventDefault(),this.focusTo("down"))}changed(){this.innerText=String(this.value).replace(new RegExp(" ","g")," "),this.setAttribute("aria-invalid","string"!=typeof this.value&&"true")}}IoString.Register();class IoSwitch extends IoButton{static get style(){return html`<style>:host {background: none;border: none;padding: 0;--io-toggle-size: 1.39em;display: flex;align-items: center;}:host:focus {outline: none;}:host > div {position: relative;flex: 0 0 calc(var(--io-toggle-size) * 2.5);border: var(--io-inset-border);border-color: var(--io-inset-border-color);color: var(--io-color-field);background-color: var(--io-background-color-field);width: calc(var(--io-toggle-size) * 2.5);height: var(--io-toggle-size);border-radius: var(--io-toggle-size);transition: background-color 0.4s;}:host[value] > div {background-color: rgba(80, 210, 355, 0.2);}:host:hover {background-color: inherit;}:host:hover > div {background-color: var(--io-background-color-light);}:host:focus > div {border-color: var(--io-color-focus);}:host > div:after {display: inline-block;position: absolute;content: '';top: 0;left: 0;height: calc(var(--io-toggle-size) - calc(2 * var(--io-border-width)));width: calc(var(--io-toggle-size) - calc(2 * var(--io-border-width)));background-color: var(--io-background-color-light);border: var(--io-outset-border);border-color: var(--io-outset-border-color);border-radius: var(--io-toggle-size);transition-timing-function: ease-in-out;transition: left 0.25s;}:host[value] > div:after {background-color: rgba(80, 210, 355, 0.75);left: calc(100% - var(--io-toggle-size));}:host[aria-invalid] > div:after {background-color: var(--io-color-error);}</style>`}static get attributes(){return{role:"switch"}}static get properties(){return{value:{type:Boolean,reflect:1}}}constructor(e){super(e),this.__properties.action.value=this.toggle,this.template([["div"]])}toggle(){this.set("value",!this.value)}changed(){this.setAttribute("aria-checked",String(this.value)),this.setAttribute("aria-invalid","boolean"!=typeof this.value&&"true")}}IoSwitch.Register();class IoTheme extends IoNode{get dark(){return html`<style>body {--io-spacing: 4px;--io-border-radius: 4px;--io-border-width: 1px;--io-background-color: rgb(42, 42, 42);--io-background-color-light: rgb(56, 56, 56);--io-background-color-dark: rgb(64, 64, 64);--io-background-color-field: rgb(16, 16, 16);--io-color: rgb(210, 210, 210);--io-color-error: rgb(255, 96, 16);--io-color-link: rgb(190, 230, 150);--io-color-focus: rgb(80, 210, 355);--io-color-field: rgb(150, 150, 150);--io-color-number: rgb(32, 164, 255);--io-color-string: rgb(240, 64, 22);--io-color-boolean: rgb(210, 90, 190);--io-gradient-button: linear-gradient(0deg, rgba(0, 0, 0, 0.25), transparent 50%), linear-gradient(180deg, rgba(255, 255, 255, 0.075), transparent 50%);--io-gradient-collapsable: linear-gradient(100deg, rgba(0, 0, 0, 0.25), transparent 50%), linear-gradient(280deg, rgba(255, 255, 255, 0.075), transparent 50%);--io-border-color: rgb(140, 140, 140);--io-border: var(--io-border-width) solid var(--io-border-color);--io-inset-border-color: rgb(32, 32, 32) var(--io-border-color) var(--io-border-color) rgb(32, 32, 32);--io-inset-border: var(--io-border-width) inset var(--io-border-color);--io-outset-border-color: var(--io-border-color) rgb(32, 32, 32) rgb(32, 32, 32) var(--io-border-color);--io-outset-border: var(--io-border-width) outset var(--io-border-color);--io-shadow: 2px 3px 5px rgba(0,0,0,0.2);}</style>`}get light(){return html`<style>body {--io-spacing: 4px;--io-border-radius: 4px;--io-border-width: 1px;--io-background-color: rgb(245, 245, 245);--io-background-color-light: rgb(255, 255, 255);--io-background-color-dark: rgb(235, 235, 235);--io-background-color-field: rgb(225, 225, 225);--io-color: rgb(42, 42, 42);--io-color-error: rgb(290, 0, 0);--io-color-link: rgb(30, 180, 30);--io-color-focus: rgb(80, 210, 355);--io-color-field: rgb(20, 20, 50);--io-color-number: rgb(32, 164, 255);--io-color-string: rgb(240, 64, 22);--io-color-boolean: rgb(210, 90, 190);--io-gradient-button: linear-gradient(0deg, rgba(0, 0, 0, 0.15), transparent 75%), linear-gradient(180deg, rgba(255, 255, 255, 0.25), transparent 75%);--io-gradient-collapsable: linear-gradient(100deg, rgba(0, 0, 0, 0.15), transparent 75%), linear-gradient(280deg, rgba(255, 255, 255, 0.25), transparent 75%);--io-border-color: rgb(210, 210, 210);--io-border: var(--io-border-width) solid var(--io-border-color);--io-inset-border-color: rgb(255, 255, 255) var(--io-border-color) var(--io-border-color) rgb(255, 255, 255);--io-inset-border: var(--io-border-width) inset var(--io-border-color);--io-outset-border-color: var(--io-border-color) rgb(250, 250, 250) rgb(250, 250, 250) var(--io-border-color);--io-outset-border: var(--io-border-width) outset var(--io-border-color);--io-shadow: 2px 3px 5px rgba(0,0,0,0.2);}</style>`}static get properties(){return{theme:"light"}}constructor(e){super(e),this.styleElement=document.createElement("style"),this.styleElement.setAttribute("id","io-theme")}changed(){let e=this[this.theme].string;e=(e=e.replace(new RegExp("<style>","g"),"")).replace(new RegExp("</style>","g"),""),this.styleElement.innerHTML=e}}IoTheme.Register(),IoTheme.singleton=new IoTheme,IoTheme.singleton.connect(),document.head.appendChild(IoTheme.singleton.styleElement);export{IoNodeMixin,IoNode,IoElement,html,Binding,NodeBindings,IoQuad,IoStorage,nodes as storageNodes,IoServiceLoader,IoBoolean,IoBreadcrumbs,IoButton,IoCollapsable,IoElementDemo,IoInspector,IoItem,IoLayout,IoMdView,IoMenuItem,IoMenuLayer,IoMenuOptions,IoMenu,IoNumber,IoObject,IoOption,IoProperties,IoSelectorSidebar,IoSelectorTabs,IoSelector,IoSlider,IoString,IoSidebar,IoSwitch,IoTheme};